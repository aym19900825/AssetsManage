webpackJsonp([18],{HIVH:function(e,t,a){"use strict";(function(e){var s,i=a("bOdI"),r=a.n(i),o=a("QmSG"),l=a("GkRW"),n=a("hbvp"),c=a("h7vj"),p=a("VEhc"),d=a("i76V"),u=a("jk2w");t.a=(s={name:"subc_agreement",components:{vheader:l.a,navs_left:n.a,navs_header:c.a,tableControle:p.a,submask:d.a,reportmask:u.a},data:function(){return{reportData:{},loading:!1,basic_url:o.a.dev_url,searchData:{page:1,limit:10,nickname:"",enabled:"",searchKey:"",searchValue:"",companyId:"",deptId:""},checkedName:["分包协议编号","委托书编号","委托方名称","类别","状态","单位名称","分包协议类别","检验/检测项目内容","检验检测项目依据","对环境和操作人员要求","对分包报告/证书的要求","检验检测费用","信息状态","录入人","录入时间","修改人","修改时间"],tableHeader:[{label:"分包协议编号",prop:"PROXY_CONTRACT_NUM"},{label:"委托书编号",prop:"PROXYNUM"},{label:"委托方名称",prop:"V_NAMEDesc"},{label:"类别",prop:"TYPE"},{label:"状态",prop:"state"},{label:"单位名称",prop:"VENDOR"},{label:"分包协议类别",prop:"TYPE"},{label:"检验/检测项目内容",prop:"P_REMARKS"},{label:"检验检测项目依据",prop:"BASIS"},{label:"对环境和操作人员要求",prop:"REQUIRE"},{label:"对分包报告/证书的要求",prop:"Q_TYPE"},{label:"检验检测费用",prop:"CHECKCOST"},{label:"信息状态",prop:"STATUS"},{label:"录入人",prop:"ENTERBY"},{label:"录入时间",prop:"ENTERDATE"},{label:"修改人",prop:"CHANGEBY"},{label:"修改时间",prop:"CHANGEDATE"}],companyId:"",deptId:"",selUser:[],subagree:[],search:!1,show:!1,down:!0,up:!1,isShow:!1,ismin:!0,fullHeight:document.documentElement.clientHeight-210+"px",searchList:{PROXY_CONTRACT_NUM:"",PROXYNUM:"",VENDOR:"",ENTERBY:"",ENTERDATE:""},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"fullname"},userData:[],page:{currentPage:1,pageSize:10,totalCount:0},aaaData:[]}},mounted:function(){var e=this;window.onresize=function(){e.fullHeight.height=document.documentElement.clientHeight-100+"px"}},methods:{rowClass:function(e){e.row,e.rowIndex;return"text-align:center"},tableControle:function(e){this.checkedName=e},sizeChange:function(e){this.page.pageSize=e,this.requestData()},currentChange:function(e){this.page.currentPage=e,this.requestData()},searchinfo:function(e){this.page.currentPage=1,this.page.pageSize=10,this.requestData()},resetbtn:function(){this.searchList={PROXY_CONTRACT_NUM:"",PROXYNUM:"",VENDOR:"",ENTERDATE:""},this.requestData()},modestsearch:function(){this.search=!this.search,this.down=!this.down,this.up=!this.up},openAddMgr:function(){},modify:function(){0!=this.selUser.length?this.selUser.length>1?this.$message({message:"不可同时修改多个数据",type:"warning"}):this.$refs.child.detail(this.selUser[0].ID):this.$message({message:"请您选择要修改的数据",type:"warning"})},view:function(e){this.$refs.child.view(e)},deluserinfo:function(){var e=this,t=this.selUser;if(0!=t.length){for(var a=this.basic_url+"/api-apps/app/checkProCont2/deletes",s=t,i=[],r=0;r<s.length;r++)i.push(s[r].ID);var o={ids:i.toString(",")};this.$confirm("确定删除该条信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;e.$axios.delete(a,{params:o}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})}else this.$message({message:"请您选择要删除的用户",type:"warning"})},importData:function(){},exportData:function(){},reportdata:function(){this.reportData.app=this.productType,this.$refs.reportChild.visible()},Printing:function(){},distribute:function(){},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},SelChange:function(e){this.selUser=e},requestData:function(e){var t=this;this.loading=!0;var a={page:this.page.currentPage,limit:this.page.pageSize,PROXY_CONTRACT_NUM:this.searchList.PROXY_CONTRACT_NUM,PROXYNUM:this.searchList.PROXYNUM,VENDOR:this.searchList.VENDOR,ENTERBY:this.searchList.ENTERBY,ENTERDATE:this.searchList.ENTERDATE},s=this.basic_url+"/api-apps/app/subcontrac";this.$axios.get(s,{params:a}).then(function(e){console.log(111),console.log(e.data),t.subagree=e.data.data,t.page.totalCount=e.data.count,t.loading=!1}).catch(function(e){})},loadMore:function(){var e=this;if(this.loadSign){if(this.loadSign=!1,this.page++,this.page>10)return;setTimeout(function(){e.loadSign=!0},1e3),console.log("到底了",this.page)}},handleNodeClick:function(e){"1"==e.type?(this.companyId=e.id,this.deptId=""):(this.deptId=e.id,this.companyId=""),this.requestData()},formatter:function(e,t){return e.enabled},renderContent:function(e,t){var a=t.node,s=t.data;t.store;return console.log(),e("span",[e("i",{class:s.iconClass}),e("span",[a.label])])},nodeClick:function(e){"icon-file-text"!=e.iconClass&&("icon-file-normal"==e.iconClass?e.iconClass="icon-file-open":e.iconClass="icon-file-normal"),this.handleNodeClick()},min3max:function(){e(".lefttree").hasClass("el-col-5")?(e(".lefttree").removeClass("el-col-5"),e(".lefttree").addClass("el-col-1"),e(".leftcont").removeClass("el-col-19"),e(".leftcont").addClass("el-col-23"),e(".icon-doubleok").removeClass("icon-double-angle-left"),e(".icon-doubleok").addClass("icon-double-angle-right")):(e(".lefttree").removeClass("el-col-1"),e(".lefttree").addClass("el-col-5"),e(".leftcont").removeClass("el-col-23"),e(".leftcont").addClass("el-col-19"),e(".icon-doubleok").removeClass("icon-double-angle-right"),e(".icon-doubleok").addClass("icon-double-angle-left")),this.ismin=!this.ismin},getKey:function(){var e=this,t=this.basic_url+"/api-user/depts/tree";this.$axios.get(t,{}).then(function(t){e.resourceData=t.data,e.treeData=e.transformTree(e.resourceData)})},transformTree:function(t){for(var a=0;a<t.length;a++)t[a].name=t[a].fullname,!t[a].pid||e.isArray(t[a].subDepts)?t[a].iconClass="icon-file-normal":t[a].iconClass="icon-file-text",e.isArray(t[a].subDepts)&&(t[a].children=this.transformTree(t[a].subDepts));return t},childByValue:function(e){this.$refs.navsheader.showClick(e)}}},r()(s,"mounted",function(){var t=this;e(".div-table").scroll(function(){t.loadMore()})}),r()(s,"mounted",function(){this.requestData(),this.getKey()}),s)}).call(t,a("7t+N"))},O9JW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("HIVH"),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"headerbg"},[a("vheader"),e._v(" "),a("navs_header",{ref:"navsheader"})],1),e._v(" "),a("div",{staticClass:"contentbg"},[a("navs_left",{ref:"navleft",on:{childByValue:e.childByValue}}),e._v(" "),a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"fixed-table-toolbar clearfix"},[a("div",{staticClass:"bs-bars pull-left"},[a("div",{staticClass:"hidden-xs",attrs:{id:"roleTableToolbar",role:"group"}},[a("button",{staticClass:"btn btn-blue button-margin",attrs:{type:"button"},on:{click:e.modify}},[a("i",{staticClass:"icon-edit"}),e._v("修改\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.exportData}},[a("i",{staticClass:"icon-download-cloud"}),e._v("导出\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.reportdata}},[a("i",{staticClass:"icon-clipboard"}),e._v("报表\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.Printing}},[a("i",{staticClass:"icon-print"}),e._v("打印\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.modestsearch}},[a("i",{staticClass:"icon-search"}),e._v("高级查询\r\n\t\t\t\t\t    \t\t"),a("i",{directives:[{name:"show",rawName:"v-show",value:e.down,expression:"down"}],staticClass:"icon-arrow1-down"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.up,expression:"up"}],staticClass:"icon-arrow1-up"})])])]),e._v(" "),a("div",{staticClass:"columns columns-right btn-group pull-right"},[e._m(0),e._v(" "),a("tableControle",{ref:"tableControle",attrs:{tableHeader:e.tableHeader,checkedName:e.checkedName},on:{tableControle:e.tableControle}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.search,expression:"search"}]},[a("el-form",{attrs:{model:e.searchList,"label-width":"70px"}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"分包协议编号",prop:"PROXY_CONTRACT_NUM","label-width":"100px"}},[a("el-input",{model:{value:e.searchList.PROXY_CONTRACT_NUM,callback:function(t){e.$set(e.searchList,"PROXY_CONTRACT_NUM",t)},expression:"searchList.PROXY_CONTRACT_NUM"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"委托书编号",prop:"PROXYNUM","label-width":"85px"}},[a("el-input",{model:{value:e.searchList.PROXYNUM,callback:function(t){e.$set(e.searchList,"PROXYNUM",t)},expression:"searchList.PROXYNUM"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"单位名称",prop:"VENDOR","label-width":"70px"}},[a("el-input",{model:{value:e.searchList.VENDOR,callback:function(t){e.$set(e.searchList,"VENDOR",t)},expression:"searchList.VENDOR"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"录入时间",prop:"ENTERDATE","label-width":"70px"}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"录入时间","value-format":"yyyy-MM-dd"},model:{value:e.searchList.ENTERDATE,callback:function(t){e.$set(e.searchList,"ENTERDATE",t)},expression:"searchList.ENTERDATE"}})],1)])],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticStyle:{"margin-top":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.searchinfo}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{"margin-top":"2px","margin-left":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.resetbtn}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:5}},[a("el-col",{staticClass:"lefttree",attrs:{span:5}},[a("div",{staticClass:"lefttreebg"},[a("div",{staticClass:"left_tree_title clearfix",on:{click:function(t){e.min3max()}}},[e.ismin?a("div",{staticClass:"pull-left pr20"},[e._v("检索分类")]):e._e(),e._v(" "),a("span",{staticClass:"pull-right navbar-minimalize minimalize-styl-2"},[a("i",{staticClass:"icon-doubleok icon-double-angle-left blue"})])]),e._v(" "),a("div",{staticClass:"left_treebg",style:{height:e.fullHeight}},[e.ismin?a("div",{staticClass:"p15"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.resourceData,"node-key":"id","default-expand-all":"",indent:22,"render-content":e.renderContent,props:e.resourceProps},on:{"node-click":e.handleNodeClick}})],1):e._e()])])]),e._v(" "),a("el-col",{staticClass:"leftcont v-resize",attrs:{span:19}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":e.rowClass,data:e.subagree,border:"",stripe:"",height:e.fullHeight,"default-sort":{prop:"subagree",order:"descending"},"element-loading-text":"加载中…","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.9)"},on:{"selection-change":e.SelChange}},[this.checkedName.length>0?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("分包协议编号")?a("el-table-column",{attrs:{label:"分包协议编号",width:"150",sortable:"",prop:"PROXY_CONTRACT_NUM"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"blue",attrs:{title:"点击查看详情"},on:{click:function(a){e.view(t.row.ID)}}},[e._v(e._s(t.row.PROXY_CONTRACT_NUM)+"\r\n\t\t\t\t\t\t\t\t\t")])]}}])}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("委托书编号")?a("el-table-column",{attrs:{label:"委托书编号",width:"150",sortable:"",prop:"PROXYNUM"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("委托方名称")?a("el-table-column",{attrs:{label:"委托方名称",width:"150",sortable:"",prop:"V_NAMEDesc"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("类别")?a("el-table-column",{attrs:{label:"类别",width:"150",sortable:"",prop:"TYPE"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("状态")?a("el-table-column",{attrs:{label:"状态",width:"150",sortable:"",prop:"state"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("单位名称")?a("el-table-column",{attrs:{label:"单位名称",width:"150",sortable:"",prop:"VENDORDesc"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("分包协议类别")?a("el-table-column",{attrs:{label:"分包协议类别",width:"150",sortable:"",prop:"TYPE"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("检验/检测项目内容")?a("el-table-column",{attrs:{label:"检验/检测项目内容",width:"150",sortable:"",prop:"P_REMARKS"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("检验检测项目依据")?a("el-table-column",{attrs:{label:"检验检测项目依据",width:"150",sortable:"",prop:"BASIS"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("对环境和操作人员要求")?a("el-table-column",{attrs:{label:"对环境和操作人员要求",width:"180",sortable:"",prop:"REQUIRE"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("对分包报告/证书的要求")?a("el-table-column",{attrs:{label:"对分包报告/证书的要求",width:"180",sortable:"",prop:"Q_TYPE"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("检验检测费用")?a("el-table-column",{attrs:{label:"检验检测费用",width:"120",sortable:"",prop:"CHECKCOST"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("信息状态")?a("el-table-column",{attrs:{label:"信息状态",width:"100",sortable:"",prop:"STATUS"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("录入人")?a("el-table-column",{attrs:{label:"录入人",width:"100",sortable:"",prop:"ENTERBY"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("录入时间")?a("el-table-column",{attrs:{label:"录入时间",width:"120",sortable:"",prop:"ENTERDATE",formatter:e.dateFormat}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("修改人")?a("el-table-column",{attrs:{label:"修改人",width:"100",sortable:"",prop:"CHANGEBY"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("修改时间")?a("el-table-column",{attrs:{label:"修改时间",width:"120",sortable:"",prop:"CHANGEDATE",formatter:e.dateFormat}}):e._e()],1),e._v(" "),this.checkedName.length>0?a("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[10,20,30,40],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}}):e._e()],1)],1)],1)]),e._v(" "),a("submask",{ref:"child",attrs:{page:e.page},on:{request:e.requestData,requestTree:e.getKey}}),e._v(" "),a("reportmask",{ref:"reportChild",attrs:{reportData:e.reportData}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btn btn-default btn-refresh",attrs:{id:"refresh",title:"刷新"}},[t("i",{staticClass:"icon-refresh"})])}]};var r=function(e){a("wk4F")},o=a("VU/8")(s.a,i,!1,r,"data-v-2e110c48",null);t.default=o.exports},"PQH+":function(e,t,a){"use strict";(function(e){var s=a("QmSG"),i=a("Ovii"),r=a("Nkt4"),o=a("RDi7"),l=a("EKWO");t.a={name:"masks",components:{approvalmask:i.default,flowhistorymask:r.default,flowmapmask:o.default,vewPoplemask:l.a},data:function(){return{approvingData:{},falg:!1,basic_url:s.a.dev_url,selUser:[],edit:!0,show:!1,isok1:!0,isok2:!1,down:!0,up:!1,activeNames:["1","2"],dialogVisible:!1,selectData:[],rules:{NUM:[{required:!1,trigger:"change",validator:function(e,t,a){""!=t&&0==/^[0-9a-zA-Z()（）]+$/.test(t)?a(new Error("请填写数字、字母或括号（编码不填写可自动生成）")):a()}}],TYPE:[{required:!0,trigger:"blur",validator:function(e,t,a){""===t?a(new Error("请填写产品类别名称")):1==/^[!@#$%^&*";',.~！@#￥%……&*《》？，。?、|]+$/.test(t)?a(new Error("请规范填写名称")):a()}}]},resourceData:[],category:{},addtitle:!0,modifytitle:!1,viewtitle:!1,dept:!1,noedit:!1,views:!1,noviews:!0,modify:!1,hintshow:!1,statusshow1:!0,statusshow2:!1,start:!1,approval:!1,dataid:"",subcontrac:"subcontrac",report:{ID:"",PROXY_CONTRACT_NUM:"",PROXYNUM:"",V_NAME:"",VENDOR:"",CONTRACT_NATURE:"",STATE:"1",STATEDesc:"草稿",ITEM_STATUS:"",TYPE:"",ITEMNAME:"",COMPDATE:"",P_REMARKS:"",BASIS:"",REQUIRES:"",Q_TYPE:"",CHECKCOST:"",STATUS:"",ENTERBY:"",ENTERDATE:"",CHANGEBY:"",CHANGEDATE:""}}},methods:{SelChange:function(e){this.selUser=e},visible:function(){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){console.log(t.data),e.report.DEPTID=t.data.deptId,e.report.ENTERBY=t.data.id;var a=new Date;e.report.ENTERDATE=e.$moment(a).format("YYYY-MM-DD")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),this.addtitle=!0,this.modifytitle=!1,this.viewtitle=!1,this.dept=!1,this.noedit=!1,this.views=!1,this.noviews=!0,this.modify=!1,this.hintshow=!1,this.statusshow1=!0,this.statusshow2=!1,this.show=!0},detailgetData:function(){var e=this,t=this.basic_url+"/api-apps/app/subcontrac/"+this.dataid;this.$axios.get(t,{}).then(function(t){e.report=t.data,e.show=!0}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),this.show=!0},detail:function(e){var t=this;this.dataid=e;var a=this.basic_url+"/api-user/users/currentMap";this.$axios.get(a,{}).then(function(e){t.report.DEPTID=e.data.deptId,t.report.CHANGEBY=e.data.id;var a=new Date;t.report.CHANGEDATE=t.$moment(a).format("yyyy-MM-dd")}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),this.detailgetData(),this.modifytitle=!0,this.addtitle=!1,this.viewtitle=!1,this.noviews=!0,this.views=!1,this.edit=!0,this.noedit=!1},view:function(e){var t=this;this.dataid=e;var a=this.basic_url+"/api-user/users/currentMap";this.$axios.get(a,{}).then(function(e){t.report.DEPTID=e.data.deptId,t.report.CHANGEBY=e.data.id;var a=new Date;t.report.CHANGEDATE=t.$moment(a).format("yyyy-MM-dd")}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),this.detailgetData(),this.modifytitle=!1,this.viewtitle=!0,this.noviews=!1,this.views=!1,this.edit=!0,this.noedit=!0;var s=this.basic_url+"/api-apps/app/subcontrac/flow/isStart/"+e;this.$axios.get(s,{}).then(function(a){if(1==a.data.resp_code)t.start=!0,t.approval=!1;else{var s=t.basic_url+"/api-apps/app/subcontrac/flow/Executors/"+e;t.$axios.get(s,{}).then(function(e){console.log(e.data.datas);for(var a=e.data.datas,s="",i=(s="",0);i<a.length;i++)s=s+a[i].username+",";-1!=s.indexOf(t.username)&&(t.approval=!0,t.start=!1)})}})},startup:function(){var e=this,t=this.basic_url+"/api-apps/app/subcontrac/flow/"+this.dataid;this.$axios.get(t,{}).then(function(t){if(1==t.data.resp_code)e.$message({message:t.data.resp_msg,type:"warning"});else{e.$message({message:t.data.resp_msg,type:"success"});var a=e.basic_url+"/api-apps/app/subcontrac/flow/Executors/"+e.dataid;e.$axios.get(a,{}).then(function(t){console.log(t.data.datas);for(var a=t.data.datas,s="",i=0;i<a.length;i++)s=s+a[i].username+",";-1!=s.indexOf(e.username)&&(e.approval=!0,e.start=!1)}),e.detailgetData()}})},approvals:function(){var e=this;this.approvingData.id=this.dataid;var t=this.basic_url+"/api-apps/app/subcontrac/flow/isEnd/"+this.dataid;this.$axios.get(t,{}).then(function(t){if(0==t.data.resp_code)e.$message({message:t.data.resp_msg,type:"warning"});else{var a=e.basic_url+"/api-apps/app/subcontrac/flow/isExecute/"+e.dataid;e.$axios.get(a,{}).then(function(t){1==t.data.resp_code?e.$message({message:t.data.resp_msg,type:"warning"}):e.$refs.approvalChild.visible()})}})},flowhistory:function(){this.approvingData.id=this.dataid,this.approvingData.app=this.subcontrac,this.$refs.flowhistoryChild.getdata(this.dataid)},flowmap:function(){this.approvingData.id=this.dataid,this.approvingData.app=this.subcontrac,this.$refs.flowmapChild.getimage()},viewpepole:function(){this.approvingData.id=this.dataid,this.approvingData.app=this.subcontrac,this.$refs.vewPopleChild.getvewPople(this.dataid)},close:function(){this.show=!1,this.$emit("request")},open:function(){this.show=!0},toggle:function(e){1==this.isok1?this.maxDialog():this.rebackDialog()},maxDialog:function(t){this.isok1=!1,this.isok2=!0,e(".mask_div").width(document.body.clientWidth),e(".mask_div").height(document.body.clientHeight-60),e(".mask_div").css("top","60px")},rebackDialog:function(){this.isok1=!0,this.isok2=!1,e(".mask_div").css("width","80%"),e(".mask_div").css("height","80%"),e(".mask_div").css("top","100px")},save:function(){var e=this;this.$refs.report.validate(function(t){if(t){var a=e.basic_url+"/api-apps/app/subcontrac/saveOrUpdate";e.$axios.post(a,e.report).then(function(t){0==t.data.resp_code?(e.$message({message:"保存成功",type:"success"}),e.$emit("request")):(e.show=!0,1==t.data.resp_code&&(""!=t.data.resp_msg?e.$message({message:t.data.resp_msg,type:"warning"}):e.$message({message:"相同数据不可重复添加！",type:"warning"})))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),e.falg=!0}else e.show=!0,e.$message({message:"未填写完整，请填写",type:"warning"}),e.falg=!1})},saveAndUpdate:function(){this.save(),this.falg&&(this.show=!1)},saveAndSubmit:function(){this.save(),this.show=!0},createinspect:function(){var e=this,t=this.report.ID,a=this.basic_url+"/api-apps/app/subcontrac/operate/createInspectProxy?ID="+t;this.$axios.get(a,{}).then(function(t){0==t.data.resp_code?e.$message({message:"生成委托书成功",type:"success"}):e.$message({message:"已经生成委托书，请勿重复生成",type:"warning"})}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})}},mounted:function(){}}}).call(t,a("7t+N"))},i76V:function(e,t,a){"use strict";var s=a("PQH+"),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.show?a("div",{staticClass:"mask"}):e._e(),e._v(" "),e.show?a("div",{staticClass:"mask_divbg"},[a("div",{staticClass:"mask_div"},[a("div",{staticClass:"mask_title_div clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.modifytitle,expression:"modifytitle"}],staticClass:"mask_title"},[e._v("修改承包方分包协议")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.viewtitle,expression:"viewtitle"}],staticClass:"mask_title"},[e._v("查看承包方分包协议")]),e._v(" "),a("div",{staticClass:"mask_anniu"},[a("span",{staticClass:"mask_span mask_max",on:{click:e.toggle}},[a("i",{class:{"icon-maximization":e.isok1,"icon-restore":e.isok2}})]),e._v(" "),a("span",{staticClass:"mask_span",on:{click:e.close}},[a("i",{staticClass:"icon-close1"})])])]),e._v(" "),a("div",{staticClass:"mask_content"},[a("el-form",{ref:"report",staticClass:"demo-adduserForm",attrs:{model:e.report,"inline-message":"",rules:e.rules,"label-width":"100px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.viewtitle,expression:"viewtitle"}],staticClass:"text-center"},[3!=this.report.STATE?a("span",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.start,expression:"start"}],attrs:{id:"start",type:"success",round:"",plain:"",size:"mini"},on:{click:e.startup}},[a("i",{staticClass:"icon-start"}),e._v(" 启动流程")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.approval,expression:"approval"}],attrs:{id:"approval",type:"warning",round:"",plain:"",size:"mini"},on:{click:e.approvals}},[a("i",{staticClass:"icon-edit-3"}),e._v(" 审批")])],1):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",plain:"",size:"mini"},on:{click:e.flowmap}},[a("i",{staticClass:"icon-git-pull-request"}),e._v(" 流程地图")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",plain:"",size:"mini"},on:{click:e.flowhistory}},[a("i",{staticClass:"icon-plan"}),e._v(" 流程历史")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",plain:"",size:"mini"},on:{click:e.viewpepole}},[a("i",{staticClass:"icon-user"}),e._v(" 当前责任人")])],1),e._v(" "),a("div",{staticClass:"accordion",attrs:{id:"information"}},[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"承包方分包协议",name:"1"}},[a("el-row",{staticClass:"pb10"},[a("el-col",{staticClass:"pull-right",attrs:{span:3}},[a("el-input",{attrs:{disabled:!0},model:{value:e.report.STATEDesc,callback:function(t){e.$set(e.report,"STATEDesc",t)},expression:"report.STATEDesc"}},[a("template",{slot:"prepend"},[e._v("状态")])],2)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"委托方名称",prop:"V_NAME "}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.V_NAME,callback:function(t){e.$set(e.report,"V_NAME",t)},expression:"report.V_NAME "}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"分包方名称",prop:"DEPTIDDesc"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.DEPTIDDesc,callback:function(t){e.$set(e.report,"DEPTIDDesc",t)},expression:"report.DEPTIDDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"分包性质",prop:"CONTRACT_NATURE"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择",disabled:e.noedit},model:{value:e.report.CONTRACT_NATURE,callback:function(t){e.$set(e.report,"CONTRACT_NATURE",t)},expression:"report.CONTRACT_NATURE"}},[a("el-option",{attrs:{label:"固定",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"临时",value:"2"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品名称",prop:"ITEMNAME"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.ITEMNAME,callback:function(t){e.$set(e.report,"ITEMNAME",t)},expression:"report.ITEMNAME"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品状态",prop:"ITEM_STATUS"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.ITEM_STATUS,callback:function(t){e.$set(e.report,"ITEM_STATUS",t)},expression:"report.ITEM_STATUS"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"检验检测项目内容",prop:"P_REMARKS"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.P_REMARKS,callback:function(t){e.$set(e.report,"P_REMARKS",t)},expression:"report.P_REMARKS"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"检验检测技术依据",prop:"BASIS"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.BASIS,callback:function(t){e.$set(e.report,"BASIS",t)},expression:"report.BASIS"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"对环境和操作人员要求",prop:"REQUIRES"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.REQUIRES,callback:function(t){e.$set(e.report,"REQUIRES",t)},expression:"report.REQUIRES"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"分包方资质证明及有效期",prop:"ONHOLTIME"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd",disabled:e.noedit},model:{value:e.report.ONHOLTIME,callback:function(t){e.$set(e.report,"ONHOLTIME",t)},expression:"report.ONHOLTIME"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"完成日期",prop:"COMPDATE"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd",disabled:e.noedit},model:{value:e.report.COMPDATE,callback:function(t){e.$set(e.report,"COMPDATE",t)},expression:"report.COMPDATE"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"检验检测费用",prop:"CHECKCOST"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.CHECKCOST,callback:function(t){e.$set(e.report,"CHECKCOST",t)},expression:"report.CHECKCOST"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"对分包报告/证书的要求",prop:"Q_TYPE"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.Q_TYPE,callback:function(t){e.$set(e.report,"Q_TYPE",t)},expression:"report.Q_TYPE"}})],1)],1)],1),e._v(" "),a("el-row",[e.dept?a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"机构",prop:"DEPTIDDesc"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.DEPTIDDesc,callback:function(t){e.$set(e.report,"DEPTIDDesc",t)},expression:"report.DEPTIDDesc"}})],1)],1):e._e()],1)],1),e._v(" "),a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:e.views,expression:"views"}],attrs:{title:"其它",name:"2"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录入人",prop:"ENTERBYDesc"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.ENTERBYDesc,callback:function(t){e.$set(e.report,"ENTERBYDesc",t)},expression:"report.ENTERBYDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录入时间",prop:"ENTERDATE"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.ENTERDATE,callback:function(t){e.$set(e.report,"ENTERDATE",t)},expression:"report.ENTERDATE"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"修改人",prop:"CHANGEBYDesc"}},[a("el-input",{attrs:{placeholder:"当前修改人",disabled:e.edit},model:{value:e.report.CHANGEBYDesc,callback:function(t){e.$set(e.report,"CHANGEBYDesc",t)},expression:"report.CHANGEBYDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"修改时间",prop:"CHANGEDATE"}},[a("el-input",{attrs:{placeholder:"当前修改时间",disabled:e.edit},model:{value:e.report.CHANGEDATE,callback:function(t){e.$set(e.report,"CHANGEDATE",t)},expression:"report.CHANGEDATE"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.noviews,expression:"noviews"}],staticClass:"el-dialog__footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAndUpdate()}}},[e._v("保存")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addtitle,expression:"addtitle"}],attrs:{type:"success"},on:{click:function(t){e.saveAndSubmit()}}},[e._v("保存并继续")]),e._v(" "),a("el-button",{on:{click:e.close}},[e._v("取消")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.viewtitle,expression:"!viewtitle"}],staticClass:"el-dialog__footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.createinspect()}}},[e._v("生成委托书")])],1)])],1)]),e._v(" "),a("approvalmask",{ref:"approvalChild",attrs:{approvingData:e.approvingData},on:{detail:e.detailgetData}}),e._v(" "),a("flowhistorymask",{ref:"flowhistoryChild",attrs:{approvingData:e.approvingData}}),e._v(" "),a("flowmapmask",{ref:"flowmapChild",attrs:{approvingData:e.approvingData}})],1):e._e()])},staticRenderFns:[]};var r=function(e){a("ziVK")},o=a("VU/8")(s.a,i,!1,r,"data-v-47a59f23",null);t.a=o.exports},wk4F:function(e,t){},ziVK:function(e,t){}});
//# sourceMappingURL=18.dda2ece0936bcf97d51a.js.map