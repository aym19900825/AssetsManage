webpackJsonp([2],{"6ybN":function(t,e){},"Am+v":function(t,e){},LPne:function(t,e){},Lp3e:function(t,e){},NNGo:function(t,e){},PQiG:function(t,e){},YaQu:function(t,e){},fpDN:function(t,e){},iMMi:function(t,e){},rWTD:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("QmSG"),s=a("GkRW"),n=a("h7vj"),r=a("hbvp"),o={name:"product2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,product2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-100+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1,selParentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.ENTERBY=a.data.nickname;var i=new Date;t.ENTERDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_product2(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/product?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_product2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_product2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_product2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},viewfield_product2:function(t,e){var a=this;if("null"==t)return this.product2Form.inspectionList=[],this.viewchildRow("null"),!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/productType2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.product2Form.inspectionList=t.data.PRODUCT2List,a.product2Form.inspectionList.length>0?a.viewchildRow(a.product2Form.inspectionList[0].ID,a.product2Form.inspectionList[0].PRO_NUM):a.viewchildRow("null");for(var i=0;i<a.product2Form.inspectionList.length;i++)a.product2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.product2Form.inspectionList[0])}).catch(function(t){})},requestData_product2:function(t){var e=this,a=this,i={page:this.page.currentPage,limit:this.page.pageSize},s=this.basic_url+"/api-apps/app/product2";this.$axios.get(s,{params:i}).then(function(t){e.page.totalCount=t.data.count;var i=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=i?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var s=[],n=1;n<=i;n++)if(void 0!==e.commentArr[n]&&e.commentArr[n].length>0)for(var r=0;r<e.commentArr[n].length;r++)e.commentArr[n][r].isEditing=!1,s.push(e.commentArr[n][r]);e.product2Form.inspectionList=s,setTimeout(function(){a.viewchildRow(a.product2Form.inspectionList[0].ID,a.product2Form.inspectionList[0].PRO_NUM)},0)}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_product2:function(t){var e=this,a=!1;if(Array.isArray(this.product2Form.inspectionList))for(var i=0;i<this.product2Form.inspectionList.length;i++){if(0!=this.product2Form.inspectionList[i].isEditing){a=!0;break}a=!1}else this.product2Form.inspectionList=[];0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={NUM:e.parentId,PRO_NUM:"",PRO_NAME:"",STATUS:"",VERSION:"",DEPTID:"",ENTERBY:e.currentUser,ENTERDATE:e.currentDate,isEditing:!0};e.product2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")},saveRow:function(t){var e=this;this.$refs.product2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/product2/saveOrUpdate",s={ID:t.ID,NUM:t.NUM,PRO_NAME:t.PRO_NAME,STATUS:t.STATUS,DEPTID:t.DEPTID,ENTERBY:t.ENTERBY,ENTERDATE:t.ENTERDATE,PRO_NUM:t.PRO_NUM,VERSION:t.VERSION};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_product2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/product2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_product2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.PRO_NUM=this.selData[0].PRO_NUM,this.catedata.PRO_NAME=this.selData[0].PRO_NAME,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")},viewchildRow:function(t,e){var a={id:t,num:e};this.$emit("parentMsd_product2",a)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"title clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("产品")]),t._v(" "),a("div",{staticClass:"columns pull-right",staticStyle:{width:"160px"}},[a("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"table-func pb10 clearfix"},[a("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_product2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1),t._v(" "),a("el-form",{ref:"product2Form",staticClass:"el-radio__table",attrs:{model:t.product2Form,"status-icon":"","inline-message":""}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.product2Form.inspectionList.filter(function(e){return!t.search||e.PRO_NAME.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"250","highlight-current-row":"","default-sort":{prop:"product2Form.inspectionList",order:"descending"}}},[a("el-table-column",{staticClass:"pl30",attrs:{label:"产品编号",sortable:"",width:"100",prop:"PRO_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".PRO_NUM"}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.PRO_NUM,callback:function(a){t.$set(e.row,"PRO_NUM",a)},expression:"scope.row.PRO_NUM"}}):a("span",{staticClass:"blue",on:{click:function(a){t.viewchildRow(e.row.ID,e.row.PRO_NUM)}}},[t._v(t._s(e.row.PRO_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称",sortable:"",prop:"PRO_NAME"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".PRO_NAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请选择"},model:{value:e.row.PRO_NAME,callback:function(a){t.$set(e.row,"PRO_NAME",a)},expression:"scope.row.PRO_NAME"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.PRO_NAME))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},on:{click:function(a){t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1)],1)]),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——产品",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.PRO_NAME.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"产品编码",width:"155",sortable:"",prop:"PRO_NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称",sortable:"",prop:"PRO_NAME"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"机构",width:"185",sortable:"",prop:"DEPTIDDesc"}}),t._v(" "),a("el-table-column",{attrs:{label:"录入时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(t){a("NNGo")},"data-v-9fef4cf2",null).exports,p={name:"inspectionSta2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,inspectionSta2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.RELEASETIME=e.$moment(i).format("YYYY-MM-DD"),t.STARTETIME=e.$moment(i).format("YYYY-MM-DD"),t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.requestData_inspectionSta2()}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/inspectionSta?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_inspectionSta2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_inspectionSta2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_inspectionSta2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_inspectionSta2:function(t,e){var a=this;if("null"==t)return this.inspectionSta2Form.inspectionList=[],this.viewchildRow("null"),!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/inspectionSta2/PRODUCT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.inspectionSta2Form.inspectionList=t.data.INSPECTION_STANDARDS2List,a.inspectionSta2Form.inspectionList.length>0?a.viewchildRow(a.inspectionSta2Form.inspectionList[0].ID,a.inspectionSta2Form.inspectionList[0].S_NUM):a.viewchildRow("null");for(var i=0;i<a.inspectionSta2Form.inspectionList.length;i++)a.inspectionSta2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.inspectionSta2Form.inspectionList[0])}).catch(function(t){})},requestData_inspectionSta2:function(t){var e=this,a=this,i={page:this.page.currentPage,limit:this.page.pageSize},s=this.basic_url+"/api-apps/app/inspectionSta2";this.$axios.get(s,{params:i}).then(function(t){e.page.totalCount=t.data.count;var i=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=i?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var s=[],n=1;n<=i;n++)if(void 0!==e.commentArr[n]&&e.commentArr[n].length>0)for(var r=0;r<e.commentArr[n].length;r++)e.commentArr[n][r].isEditing=!1,s.push(e.commentArr[n][r]);e.inspectionSta2Form.inspectionList=s,setTimeout(function(){a.viewchildRow(a.inspectionSta2Form.inspectionList[0].ID,a.inspectionSta2Form.inspectionList[0].S_NUM)},0)}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_inspectionSta2:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属产品",type:"warning"});else{for(var a=!1,i=0;i<this.inspectionSta2Form.inspectionList.length;i++){if(0!=this.inspectionSta2Form.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD"),e.currentDateTime=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");e.$moment(a).format("YYYYMMDDHHmmss");var i={PRO_NUM:e.parentId,S_NUM:"",S_NAME:"",STATUS:"",VERSION:"",DEPTID:"",RELEASETIME:e.currentDate,STARTETIME:e.currentDate,ENTERBY:e.currentUser,ENTERDATE:e.currentDateTime,isEditing:!0};e.inspectionSta2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.inspectionSta2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/inspectionSta2/saveOrUpdate",s={ID:t.ID,PRO_NUM:t.PRO_NUM,S_NUM:t.S_NUM,S_NAME:t.S_NAME,STATUS:t.STATUS,DEPTID:t.DEPTID,RELEASETIME:t.RELEASETIME,STARTETIME:t.STARTETIME,ENTERBY:t.ENTERBY,ENTERDATE:t.ENTERDATE,VERSION:t.VERSION};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_inspectionSta2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/inspectionSta2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_inspectionSta2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.S_NUM=this.selData[0].S_NUM,this.catedata.S_NAME=this.selData[0].S_NAME,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")},viewchildRow:function(t,e){var a={id:t,num:e};this.$emit("parentMsd_inspectionSta2",a)}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"title clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("检验/检测标准")]),t._v(" "),a("div",{staticClass:"columns pull-right",staticStyle:{width:"160px"}},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"table-func pb10 clearfix"},[a("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_inspectionSta2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1),t._v(" "),a("el-form",{ref:"inspectionSta2Form",staticClass:"el-radio__table",attrs:{model:t.inspectionSta2Form,"status-icon":"","inline-message":""}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.inspectionSta2Form.inspectionList.filter(function(e){return!t.search||e.S_NAME.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"250","highlight-current-row":"","default-sort":{prop:"inspectionSta2Form.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"标准编码",sortable:"",width:"100",prop:"S_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".S_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.S_NUM,callback:function(a){t.$set(e.row,"S_NUM",a)},expression:"scope.row.S_NUM"}}):a("span",{staticClass:"blue",on:{click:function(a){t.viewchildRow(e.row.ID,e.row.S_NUM)}}},[t._v(t._s(e.row.S_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"标准名称",sortable:"",prop:"S_NAME"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".S_NAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请输入内容"},model:{value:e.row.S_NAME,callback:function(a){t.$set(e.row,"S_NAME",a)},expression:"scope.row.S_NAME"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.S_NAME))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1)],1)]),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——检验/检测标准",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.S_NUM.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准编码",width:"155",sortable:"",prop:"S_NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准名称",sortable:"",prop:"S_NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"机构",width:"185",sortable:"",prop:"DEPTIDDesc"}}),t._v(" "),a("el-table-column",{attrs:{label:"录入时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(p,d,!1,function(t){a("YaQu")},"data-v-3dca6b5a",null).exports,h={name:"inspectionPro2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,inspectionPro2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_inspectionPro2(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/inspectionPro?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_inspectionPro2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_inspectionPro2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=30,this.viewfield_inspectionPro2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_inspectionPro2:function(t,e){var a=this;if("null"==t)return this.inspectionPro2Form.inspectionList=[],this.viewchildRow("null"),!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/inspectionPro2/INSPECTION_STANDARDS2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.inspectionPro2Form.inspectionList=t.data.INSPECTION_PROJECT2List,a.inspectionPro2Form.inspectionList.length>0?a.viewchildRow(a.inspectionPro2Form.inspectionList[0].ID,a.inspectionPro2Form.inspectionList[0].P_NUM):a.viewchildRow("null");for(var i=0;i<a.inspectionPro2Form.inspectionList.length;i++)a.inspectionPro2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.inspectionPro2Form.inspectionList[0])}).catch(function(t){})},requestData_inspectionPro2:function(t){var e=this,a=this,i={page:this.page.currentPage,limit:this.page.pageSize},s=this.basic_url+"/api-apps/app/inspectionPro2";this.$axios.get(s,{params:i}).then(function(t){e.page.totalCount=t.data.count;var i=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=i?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var s=[],n=1;n<=i;n++)if(void 0!==e.commentArr[n]&&e.commentArr[n].length>0)for(var r=0;r<e.commentArr[n].length;r++)e.commentArr[n][r].isEditing=!1,s.push(e.commentArr[n][r]);e.inspectionPro2Form.inspectionList=s,setTimeout(function(){a.viewchildRow(a.inspectionPro2Form.inspectionList[0].ID,a.inspectionPro2Form.inspectionList[0].P_NUM)},0)}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_inspectionPro2:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测标准",type:"warning"});else{for(var a=!1,i=0;i<this.inspectionPro2Form.inspectionList.length;i++){if(0!=this.inspectionPro2Form.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");e.$moment(a).format("YYYYMMDDHHmmss");var i={S_NUM:e.parentId,P_NUM:"",P_NAME:"",UNITCOST:"",STATUS:"",VERSION:"",DEPTID:"",ENTERBY:e.currentUser,ENTERDATE:e.currentDate,isEditing:!0};e.inspectionPro2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.inspectionPro2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/inspectionPro2/saveOrUpdate",s={ID:t.ID,S_NUM:t.S_NUM,P_NUM:t.P_NUM,P_NAME:t.P_NAME,UNITCOST:t.UNITCOST,STATUS:t.STATUS,DEPTID:t.DEPTID,ENTERBY:t.CHANGEBY,ENTERDATE:t.CHANGEDATE,VERSION:t.VERSION};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_inspectionPro2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/inspectionPro2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_inspectionPro2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.P_NUM=this.selData[0].P_NUM,this.catedata.P_NAME=this.selData[0].P_NAME,this.catedata.UNITCOST=this.selData[0].UNITCOST,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")},viewchildRow:function(t,e){var a={id:t,num:e};this.$emit("parentMsd_inspectionPro2",a)}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"title clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("检验/检测项目")]),t._v(" "),a("div",{staticClass:"columns pull-right",staticStyle:{width:"160px"}},[a("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"table-func pb10 clearfix"},[a("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_inspectionPro2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1),t._v(" "),a("el-form",{ref:"inspectionPro2Form",staticClass:"el-radio__table",attrs:{model:t.inspectionPro2Form,"status-icon":"","inline-message":""}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:(Array.isArray(t.inspectionPro2Form.inspectionList)?t.inspectionPro2Form.inspectionList:[]).filter(function(e){return!t.search||e.P_NAME.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"250","highlight-current-row":"","default-sort":{prop:"inspectionPro2Form.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"项目编号",sortable:"",width:"100",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",{staticClass:"blue",on:{click:function(a){t.viewchildRow(e.row.ID,e.row.P_NUM)}}},[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"项目名称",sortable:"",width:"160",prop:"P_NAME"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请选择"},model:{value:e.row.P_NAME,callback:function(a){t.$set(e.row,"P_NAME",a)},expression:"scope.row.P_NAME"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.P_NAME))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"单价",sortable:"",width:"100",prop:"UNITCOST"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".UNITCOST",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"自动生成"},model:{value:e.row.UNITCOST,callback:function(a){t.$set(e.row,"UNITCOST",a)},expression:"scope.row.UNITCOST"}}):a("span",[t._v(t._s(e.row.UNITCOST))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1)],1)]),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——检验/检测项目",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.P_NAME.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"项目编码",width:"155",sortable:"",prop:"P_NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"项目名称",sortable:"",prop:"P_NAME"}}),t._v(" "),a("el-table-column",{attrs:{label:"单价",sortable:"",align:"right",prop:"UNITCOST"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"机构",width:"185",sortable:"",prop:"DEPTIDDesc"}}),t._v(" "),a("el-table-column",{attrs:{label:"录入时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(h,m,!1,function(t){a("LPne")},"data-v-041ced22",null).exports,f=a("bOdI"),v=a.n(f),b={name:"professionGro",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,professionGroForm:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_professionGro(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a=this.basic_url+"/api-user/depts/findByPid/"+this.parentIds;this.$axios.get(a,{}).then(function(t){e.categoryList=t.data}).catch(function(t){console.log("请求失败")})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_professionGro(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_professionGro(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_professionGro(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_professionGro:function(t,e){var a=this;if("null"==t)return this.professionGroForm.inspectionList=[],!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/professionGro/INSPECTION_PROJECT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.professionGroForm.inspectionList=t.data.PROFESSION_GROUPList;for(var i=0;i<a.professionGroForm.inspectionList.length;i++)a.professionGroForm.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.professionGroForm.inspectionList[0])}).catch(function(t){})},requestData_professionGro:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize},i=this.basic_url+"/api-apps/app/professionGro";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.professionGroForm.inspectionList=i}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_professionGro:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测项目",type:"warning"});else{for(var a=!1,i=0;i<this.professionGroForm.inspectionList.length;i++){if(0!=this.professionGroForm.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname,e.currentDept=t.data.deptid;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={P_NUM:e.parentId,PROF_NUM:"",PROF_GROUP:"",STATUS:"",VERSION:"",DEPTID:"",ENTERBY:e.currentUser,ENTERDATE:e.currentDate,isEditing:!0};e.professionGroForm.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.professionGroForm.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/professionGro/saveOrUpdate",s=v()({ID:t.ID,P_NUM:t.P_NUM,PROF_NUM:t.PROF_NUM,PROF_GROUP:t.PROF_GROUP,STATUS:t.STATUS,DEPTID:t.DEPTID,ENTERBY:t.ENTERBY,ENTERDATE:t.ENTERDATE,VERSION:t.VERSION},"VERSION",t.VERSION);e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_professionGro(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/professionGro/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_professionGro(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.PROF_NUM=this.selData[0].code,this.catedata.PROF_GROUP=this.selData[0].fullname,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"text item"},[a("div",{staticClass:"clearfix relative"},[a("div",{staticClass:"columns pull-left"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入专业组名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"table-func pull-right"},[a("el-button",{staticClass:"pull-right",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_professionGro}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1)]),t._v(" "),a("el-form",{ref:"professionGroForm",attrs:{model:t.professionGroForm}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:t.professionGroForm.inspectionList.filter(function(e){return!t.search||e.PROF_GROUP.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"280","highlight-current-row":"highlight-current-row","default-sort":{prop:"professionGroForm.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"所属项目编号",width:"120",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"专业组编号",width:"160",prop:"PROF_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".PROF_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.PROF_NUM,callback:function(a){t.$set(e.row,"PROF_NUM",a)},expression:"scope.row.PROF_NUM"}}):a("span",[t._v(t._s(e.row.PROF_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"专业组名称",sortable:"",prop:"PROF_GROUP"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".PROF_GROUP",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请选择"},model:{value:e.row.PROF_GROUP,callback:function(a){t.$set(e.row,"PROF_GROUP",a)},expression:"scope.row.PROF_GROUP"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.PROF_GROUP))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pull-right pt10 pb10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——专业组",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入专业组名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.fullname.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"专业组编号",width:"125",sortable:"",prop:"id"}}),t._v(" "),a("el-table-column",{attrs:{label:"所属编号",width:"155",sortable:"",prop:"pid"}}),t._v(" "),a("el-table-column",{attrs:{label:"机构编码",width:"185",sortable:"",prop:"code"}}),t._v(" "),a("el-table-column",{attrs:{label:"专业组名称",sortable:"",prop:"fullname"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"version",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"120",prop:"createTime",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"updateTime",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var w=a("VU/8")(b,_,!1,function(t){a("PQiG")},"data-v-6d19f1d3",null).exports,E={name:"inspectionMet2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,inspectionMet2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options2:[{value:"检验检测方法1",label:"检验检测方法1"},{value:"检验检测方法2",label:"检验检测方法2"},{value:"检验检测方法3",label:"检验检测方法3"},{value:"检验检测方法4",label:"检验检测方法4"},{value:"检验检测方法5",label:"检验检测方法5"}],options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_inspectionMet2(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/inspectionMet?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_inspectionMet2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_inspectionMet2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_inspectionMet2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_inspectionMet2:function(t,e){var a=this;if("null"==t)return this.inspectionMet2Form.inspectionList=[],!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/inspectionMet2/INSPECTION_PROJECT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.inspectionMet2Form.inspectionList=t.data.INSPECTION_METHOD2List;for(var i=0;i<a.inspectionMet2Form.inspectionList.length;i++)a.inspectionMet2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.inspectionMet2Form.inspectionList[0])}).catch(function(t){})},requestData_inspectionMet2:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize},i=this.basic_url+"/api-apps/app/inspectionMet2";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.inspectionMet2Form.inspectionList=i}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_inspectionMet2:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测项目",type:"warning"});else{var a=!1;console.log(this.inspectionMet2Form.inspectionList);for(var i=0;i<this.inspectionMet2Form.inspectionList.length;i++){if(0!=this.inspectionMet2Form.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={P_NUM:e.parentId,M_NUM:"",M_NAME:"",M_ENAME:"",M_TYPE:"",STATUS:"",VERSION:"",DEPTID:"",ENTERBY:e.currentUser,ENTERDATE:e.currentDate,isEditing:!0};e.inspectionMet2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.inspectionMet2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/inspectionMet2/saveOrUpdate",s={ID:t.ID,P_NUM:t.P_NUM,M_NUM:t.M_NUM,M_NAME:t.M_NAME,M_ENAME:t.M_ENAME,M_TYPE:t.M_TYPE,STATUS:t.STATUS,VERSION:t.VERSION,DEPTID:t.DEPTID,ENTERBY:t.CHANGEBY,ENTERDATE:t.CHANGEDATE};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_inspectionMet2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/inspectionMet2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_inspectionMet2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.M_NUM=this.selData[0].M_NUM,this.catedata.M_NAME=this.selData[0].M_NAME,this.catedata.M_ENAME=this.selData[0].M_ENAME,this.catedata.M_TYPE=this.selData[0].M_TYPE,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")}}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"text item"},[a("div",{staticClass:"clearfix relative"},[a("div",{staticClass:"columns pull-left"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入方法中文名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"table-func pull-right"},[a("el-button",{staticClass:"pull-right",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_inspectionMet2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1)]),t._v(" "),a("el-form",{ref:"inspectionMet2Form",attrs:{model:t.inspectionMet2Form}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:t.inspectionMet2Form.inspectionList.filter(function(e){return!t.search||e.M_NAME.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"280","highlight-current-row":"highlight-current-row","default-sort":{prop:"inspectionMet2Form.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"所属项目编号",width:"120",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"方法编号",width:"160",prop:"M_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".M_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"自动生成"},model:{value:e.row.M_NUM,callback:function(a){t.$set(e.row,"M_NUM",a)},expression:"scope.row.M_NUM"}}):a("span",[t._v(t._s(e.row.M_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"方法中文名称",sortable:"",prop:"M_NAME"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".M_NAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请选择"},model:{value:e.row.M_NAME,callback:function(a){t.$set(e.row,"M_NAME",a)},expression:"scope.row.M_NAME"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.M_NAME))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"方法英文名称",width:"160",sortable:"",prop:"M_ENAME"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".M_ENAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"自动生成"},model:{value:e.row.M_ENAME,callback:function(a){t.$set(e.row,"M_ENAME",a)},expression:"scope.row.M_ENAME"}}):a("span",[t._v(t._s(e.row.M_ENAME))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类别",sortable:"",width:"160",prop:"M_TYPE"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".M_TYPE",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"自动生成"},model:{value:e.row.M_TYPE,callback:function(a){t.$set(e.row,"M_TYPE",a)},expression:"scope.row.M_TYPE"}}):a("span",[t._v(t._s(e.row.M_TYPE))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pull-right pt10 pb10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——检验/检测方法",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入方法中文名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.M_NAME.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"方法编号",width:"125",sortable:"",prop:"M_NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"方法中文名称",sortable:"",prop:"M_NAME"}}),t._v(" "),a("el-table-column",{attrs:{label:"方法英文名称",sortable:"",prop:"M_ENAME"}}),t._v(" "),a("el-table-column",{attrs:{label:"方法类别",sortable:"",prop:"M_TYPE"}}),t._v(" "),a("el-table-column",{attrs:{label:"方法类别",sortable:"",prop:"M_TYPE"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var P=a("VU/8")(E,D,!1,function(t){a("6ybN")},"data-v-2fd0c98c",null).exports,I={name:"rawDataTem2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,rawDataTem2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_rawDataTem2(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/rawDataTem2?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_rawDataTem2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_rawDataTem2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_rawDataTem2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_rawDataTem2:function(t,e){var a=this;if("null"==t)return this.rawDataTem2Form.inspectionList=[],!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/rawDataTem2/INSPECTION_PROJECT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.rawDataTem2Form.inspectionList=t.data.INSPECTION_REPORT_TEMPLATE2List;for(var i=0;i<a.rawDataTem2Form.inspectionList.length;i++)a.rawDataTem2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.rawDataTem2Form.inspectionList[0])}).catch(function(t){})},requestData_rawDataTem2:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize},i=this.basic_url+"/api-apps/app/rawDataTem2";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.rawDataTem2Form.inspectionList=i}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_rawDataTem2:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测项目",type:"warning"});else{for(var a=!1,i=0;i<this.rawDataTem2Form.inspectionList.length;i++){if(0!=this.rawDataTem2Form.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={P_NUM:e.parentId,NUM:"",DECRIPTION:"",STATUS:"",VERSION:"",DEPTID:"",CHANGEBY:e.currentUser,CHANGEDATE:e.currentDate,isEditing:!0};e.rawDataTem2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.rawDataTem2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/rawDataTem2/saveOrUpdate",s={ID:t.ID,P_NUM:t.P_NUM,NUM:t.NUM,DECRIPTION:t.DECRIPTION,STATUS:t.STATUS,VERSION:t.VERSION,DEPTID:t.DEPTID,CHANGEBY:t.CHANGEBY,CHANGEDATE:t.CHANGEDATE};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_rawDataTem2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/rawDataTem2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_rawDataTem2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.NUM=this.selData[0].NUM,this.catedata.DECRIPTION=this.selData[0].DECRIPTION,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")}}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"text item"},[a("div",{staticClass:"clearfix relative"},[a("div",{staticClass:"columns pull-left"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入原始数据模板描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"table-func pull-right"},[a("el-button",{staticClass:"pull-right",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_rawDataTem2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1)]),t._v(" "),a("el-form",{ref:"rawDataTem2Form",attrs:{model:t.rawDataTem2Form}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:t.rawDataTem2Form.inspectionList.filter(function(e){return!t.search||e.DECRIPTION.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"280","highlight-current-row":"highlight-current-row","default-sort":{prop:"rawDataTem2Form.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"所属项目编号",width:"120",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"原始数据编号",width:"160",prop:"NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.NUM,callback:function(a){t.$set(e.row,"NUM",a)},expression:"scope.row.NUM"}}):a("span",[t._v(t._s(e.row.NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"原始数据模板描述",sortable:"",prop:"DECRIPTION"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".DECRIPTION",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"请选择",disabled:""},model:{value:e.row.DECRIPTION,callback:function(a){t.$set(e.row,"DECRIPTION",a)},expression:"scope.row.DECRIPTION"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.DECRIPTION))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pull-right pt10 pb10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——原始数据模板",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入原始数据描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.DECRIPTION.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"原始数据编号",width:"125",sortable:"",prop:"NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"原始数据描述",sortable:"",prop:"DECRIPTION"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var T=a("VU/8")(I,M,!1,function(t){a("Am+v")},"data-v-272eb30a",null).exports,N={name:"inspectionRepTem2",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,inspectionRepTem2Form:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_inspectionRepTem2(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/inspectionRepTem?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_inspectionRepTem2(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_inspectionRepTem2(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_inspectionRepTem2(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_inspectionRepTem2:function(t,e){var a=this;if("null"==t)return this.inspectionRepTem2Form.inspectionList=[],!1;this.parentId=e,this.selParentId=t;var i=this.basic_url+"/api-apps/app/inspectionRepTem2/INSPECTION_PROJECT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.inspectionRepTem2Form.inspectionList=t.data.INSPECTION_REPORT_TEMPLATE2List;for(var i=0;i<a.inspectionRepTem2Form.inspectionList.length;i++)a.inspectionRepTem2Form.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.inspectionRepTem2Form.inspectionList[0])}).catch(function(t){})},requestData_inspectionRepTem2:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize},i=this.basic_url+"/api-apps/app/inspectionRepTem2";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.inspectionRepTem2Form.inspectionList=i}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_inspectionRepTem2:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测项目",type:"warning"});else{for(var a=!1,i=0;i<this.inspectionRepTem2Form.inspectionList.length;i++){if(0!=this.inspectionRepTem2Form.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={P_NUM:e.parentId,NUM:"",DECRIPTION:"",STATUS:"",VERSION:"",DEPTID:"",CHANGEBY:e.currentUser,CHANGEDATE:e.currentDate,isEditing:!0};e.inspectionRepTem2Form.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.inspectionRepTem2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/inspectionRepTem2/saveOrUpdate",s={ID:t.ID,P_NUM:t.P_NUM,NUM:t.NUM,DECRIPTION:t.DECRIPTION,STATUS:t.STATUS,VERSION:t.VERSION,DEPTID:t.DEPTID,CHANGEBY:t.CHANGEBY,CHANGEDATE:t.CHANGEDATE};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_inspectionRepTem2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/inspectionRepTem2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_inspectionRepTem2(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.NUM=this.selData[0].NUM,this.catedata.DECRIPTION=this.selData[0].DECRIPTION,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"text item"},[a("div",{staticClass:"clearfix relative"},[a("div",{staticClass:"columns pull-left"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入报告模板描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"table-func pull-right"},[a("el-button",{staticClass:"pull-right",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_inspectionRepTem2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1)]),t._v(" "),a("el-form",{ref:"inspectionRepTem2Form",attrs:{model:t.inspectionRepTem2Form}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:t.inspectionRepTem2Form.inspectionList.filter(function(e){return!t.search||e.DECRIPTION.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"280","highlight-current-row":"highlight-current-row","default-sort":{prop:"inspectionRepTem2Form.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"所属项目编号",width:"120",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"报告编号",width:"160",prop:"NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.NUM,callback:function(a){t.$set(e.row,"NUM",a)},expression:"scope.row.NUM"}}):a("span",[t._v(t._s(e.row.NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"报告模板描述",sortable:"",prop:"DECRIPTION"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".DECRIPTION",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"请选择",disabled:""},model:{value:e.row.DECRIPTION,callback:function(a){t.$set(e.row,"DECRIPTION",a)},expression:"scope.row.DECRIPTION"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.DECRIPTION))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pull-right pt10 pb10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——检验/检测报告模板",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入报告描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.DECRIPTION.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"报告编号",width:"125",sortable:"",prop:"NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"报告描述",sortable:"",prop:"DECRIPTION"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var C=a("VU/8")(N,S,!1,function(t){a("fpDN")},"data-v-6fca22fb",null).exports,R={name:"rawDataAsset",components:{},props:["parentIds"],data:function(){return{basic_url:i.a.dev_url,rawDataAssetForm:{inspectionList:[]},fullHeight:document.documentElement.clientHeight-210+"px",departmentId:"",categoryList:[],catedata:"",dialogVisible3:!1,selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:10,enabled:""},search:"",page:{currentPage:1,pageSize:10,totalCount:0},parentId:1}},methods:{iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},modifyversion:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(a){t.CHANGEBY=a.data.nickname;var i=new Date;t.CHANGEDATE=e.$moment(i).format("YYYY-MM-DD  HH:mm:ss")}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.viewfield_rawDataAsset(this.selParentId,this.parentId)}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/asset?DEPTID="+this.parentIds,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.viewfield_rawDataAsset(this.selParentId,this.parentId)},currentChange:function(t){this.page.currentPage=t,this.viewfield_rawDataAsset(this.selParentId,this.parentId)},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.viewfield_rawDataAsset(this.selParentId,this.parentId)},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},viewfield_rawDataAsset:function(t,e){var a=this;if("null"==t)return this.rawDataAssetForm.inspectionList=[],!1;this.parentId=e;var i=this.basic_url+"/api-apps/app/rawDataAsset/INSPECTION_PROJECT2/"+t;this.$axios.get(i,{}).then(function(t){a.page.totalCount=t.data.count;var e=Math.ceil(a.page.totalCount/a.page.pageSize);a.page.currentPage>=e?a.loadSign=!1:a.loadSign=!0,a.rawDataAssetForm.inspectionList=t.data.RAW_DATA_ASSETList;for(var i=0;i<a.rawDataAssetForm.inspectionList.length;i++)a.rawDataAssetForm.inspectionList[i].isEditing=!1;a.$refs.singleTable.setCurrentRow(a.rawDataAssetForm.inspectionList[0])}).catch(function(t){})},requestData_rawDataAsset:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize},i=this.basic_url+"/api-apps/app/rawDataAsset";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.rawDataAssetForm.inspectionList=i}).catch(function(t){})},SelChange:function(t){this.selData=t},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_rawDataAsset:function(t){var e=this;if(1==this.parentId)this.$message({message:"请选择所属检验/检测项目",type:"warning"});else{for(var a=!1,i=0;i<this.rawDataAssetForm.inspectionList.length;i++){if(0!=this.rawDataAssetForm.inspectionList[i].isEditing){a=!0;break}a=!1}0==a?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.currentUser=t.data.nickname;var a=new Date;e.currentDate=e.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={P_NUM:e.parentId,DECRIPTION:"",STATUS:"",NUM:"",VERSION:"",DEPTID:"",CHANGEBY:e.currentUser,CHANGEDATE:e.currentDate,isEditing:!0};e.rawDataAssetForm.inspectionList.unshift(i)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")}},saveRow:function(t){var e=this;this.$refs.rawDataAssetForm.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/rawDataAsset/saveOrUpdate",s={ID:t.ID,P_NUM:t.P_NUM,NUM:t.NUM,DECRIPTION:t.DECRIPTION,STATUS:t.STATUS,VERSION:t.VERSION,DEPTID:t.DEPTID,CHANGEBY:t.CHANGEBY,CHANGEDATE:t.CHANGEDATE};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.viewfield_rawDataAsset(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此产品类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/rawDataAsset/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.viewfield_rawDataAsset(e.selParentId,e.parentId))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.NUM=this.selData[0].ASSETNUM,this.catedata.DECRIPTION=this.selData[0].DESCRIPTION,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")}}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"text item"},[a("div",{staticClass:"clearfix relative"},[a("div",{staticClass:"columns pull-left"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入设备名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"table-func pull-right"},[a("el-button",{staticClass:"pull-right",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_rawDataAsset}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1)]),t._v(" "),a("el-form",{ref:"rawDataAssetForm",attrs:{model:t.rawDataAssetForm}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:t.rawDataAssetForm.inspectionList.filter(function(e){return!t.search||e.DECRIPTION.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"280","highlight-current-row":"highlight-current-row","default-sort":{prop:"rawDataAssetForm.inspectionList",order:"descending"}}},[a("el-table-column",{attrs:{label:"所属项目编号",width:"120",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".P_NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.row.P_NUM,callback:function(a){t.$set(e.row,"P_NUM",a)},expression:"scope.row.P_NUM"}}):a("span",[t._v(t._s(e.row.P_NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"设备编号",width:"160",prop:"NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".NUM",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:""},model:{value:e.row.NUM,callback:function(a){t.$set(e.row,"NUM",a)},expression:"scope.row.NUM"}}):a("span",[t._v(t._s(e.row.NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"设备名称",sortable:"",prop:"DECRIPTION"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".DECRIPTION",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"请选择",disabled:""},model:{value:e.row.DECRIPTION,callback:function(a){t.$set(e.row,"DECRIPTION",a)},expression:"scope.row.DECRIPTION"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.DECRIPTION))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pull-right pt10 pb10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——检测仪器",height:"300px",visible:t.dialogVisible3,width:"80%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList,border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"设备编号",width:"125",sortable:"",prop:"ASSETNUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"设备名称",sortable:"",prop:"DESCRIPTION"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var x=a("VU/8")(R,A,!1,function(t){a("iMMi")},"data-v-98bf4cd4",null).exports,y={name:"inspection_project",components:{vheader:s.a,navs_left:r.a,navs_header:n.a,product2child:c,inspectionSta2child:u,inspectionPro2child:g,professionGrochild:w,inspectionMet2child:P,rawDataTem2child:T,inspectionRepTem2child:C,rawDataAssetchild:x},data:function(){return{basic_url:i.a.dev_url,Select_DEPTID:[],fullHeight:document.documentElement.clientHeight-210+"px",formInline:{DEPTID:""},productType2Form:{inspectionList:[]},departmentId:"",categoryList:[],catedata:"",selData:[],isEditing:"",loadSign:!0,commentArr:{},value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],searchData:{page:1,limit:20,enabled:""},search:"",page:{currentPage:1,pageSize:20,totalCount:0},product2Id:0,inspectionSta2Id:0,inspectionPro2Id:0,dialogVisible3:!1,parentId:1}},methods:{rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},childMsd_product2:function(t){this.$refs.inspectionSta2child.viewfield_inspectionSta2(t.id,t.num)},childMsd_inspectionSta2:function(t){this.inspectionSta2Id=t,this.$refs.inspectionPro2child.viewfield_inspectionPro2(t.id,t.num)},childMsd_inspectionPro2:function(t){this.inspectionPro2Id=t,this.$refs.professionGrochild.viewfield_professionGro(t.id,t.num),this.$refs.inspectionMet2child.viewfield_inspectionMet2(t.id,t.num),this.$refs.rawDataTem2child.viewfield_rawDataTem2(t.id,t.num),this.$refs.inspectionRepTem2child.viewfield_inspectionRepTem2(t.id,t.num),this.$refs.rawDataAssetchild.viewfield_rawDataAsset(t.id,t.num)},iconOperation:function(t,e,a,i){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},SelChange:function(t){this.selData=t},loadMore:function(){var t=this,e=sessionStorage.getItem("up2down");if(this.loadSign){if("down"==e){if(this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return this.page.currentPage=Math.ceil(this.page.totalCount/this.page.pageSize),!1}else if(this.page.currentPage--,this.page.currentPage<1)return this.page.currentPage=1,!1;this.loadSign=!1,setTimeout(function(){t.loadSign=!0},1e3),this.requestData()}},addprobtn:function(t){var e=this;this.catedata=t,this.dialogVisible3=!0;var a={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-apps/app/productType?DEPTID="+this.formInline.DEPTID,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)i.push(e.commentArr[s][n]);e.categoryList=i}).catch(function(t){})},sizeChange:function(t){this.page.pageSize=t,this.requestData()},currentChange:function(t){this.page.currentPage=t,this.requestData()},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=20,this.requestData()},judge:function(t){return t.enabled?"活动":"不活动"},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},indexMethod:function(t){return t+1},getDEPTID:function(){var t=this,e=this.basic_url+"/api-user/users/currentMap";this.$axios.get(e,{}).then(function(e){t.departmentId=e.data.deptId;var a=e.data.deptName,i=t.basic_url+"/api-user/depts/findByPid/"+t.departmentId;t.$axios.get(i,{}).then(function(e){t.Select_DEPTID=e.data,128==t.departmentId?t.formInline.DEPTID=e.data[0].id:(t.Select_DEPTID.push({id:t.departmentId,fullname:a}),t.formInline.DEPTID=t.departmentId),t.requestData()}).catch(function(t){console.log("请求失败")})}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})},requestData:function(t){var e=this,a={page:this.page.currentPage,limit:this.page.pageSize,DEPTID:this.formInline.DEPTID},i=this.basic_url+"/api-apps/app/productType2";this.$axios.get(i,{params:a}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var n=0;n<e.commentArr[s].length;n++)e.commentArr[s][n].isEditing=!1,i.push(e.commentArr[s][n]);e.productType2Form.inspectionList=i,e.productType2Form.inspectionList.length>0?e.viewchildRow(e.productType2Form.inspectionList[0].ID,e.productType2Form.inspectionList[0].NUM):e.viewchildRow("null"),e.$refs.singleTable.setCurrentRow(e.productType2Form.inspectionList[0])}).catch(function(t){})},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},formatter:function(t,e){return t.enabled},addfield_productType2:function(){for(var t=this,e=!1,a=0;a<this.productType2Form.inspectionList.length;a++){if(0!=this.productType2Form.inspectionList[a].isEditing){e=!0;break}e=!1}0==e?this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(e){t.currentUser=e.data.nickname;var a=new Date;t.currentDate=t.$moment(a).format("YYYY-MM-DD  HH:mm:ss");var i={TYPE:"",STATUS:"",NUM:"",VERSION:"",DEPTID:"",ENTERBY:t.currentUser,ENTERDATE:t.currentDate,isEditing:!0};t.productType2Form.inspectionList.unshift(i)}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}):this.$message.warning("请先保存当前编辑项")},saveRow:function(t){var e=this;this.$refs.productType2Form.validate(function(a){if(t.VERSION=t.VERSION+1,!a)return!1;var i=e.basic_url+"/api-apps/app/productType2/saveOrUpdate",s={ID:t.ID,TYPE:t.TYPE,NUM:t.NUM,VERSION:t.VERSION,DEPTID:t.DEPTID,STATUS:t.STATUS,ENTERBY:t.ENTERBY,ENTERDATE:t.ENTERDATE};e.$axios.post(i,s).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})})},deleteRow:function(t){var e=this;this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){a.value;var i=e.basic_url+"/api-apps/app/productType2/"+t.ID;e.$axios.delete(i,{}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})},addproclass:function(){this.dialogVisible3=!1,this.catedata.NUM=this.selData[0].NUM,this.catedata.TYPE=this.selData[0].TYPE,this.catedata.DEPTID=this.selData[0].DEPTID,this.catedata.VERSION=this.selData[0].VERSION,this.$emit("request")},viewchildRow:function(t,e){this.$refs.product2child.viewfield_product2(t,e)}},mounted:function(){this.getDEPTID()}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"headerbg"},[a("vheader"),t._v(" "),a("navs_header",{ref:"navsheader"})],1),t._v(" "),a("div",{staticClass:"contentbg"},[a("div",{staticClass:"wrapper wrapper-content wrapperall",style:{height:t.fullHeight}},[a("div",{staticClass:"ibox-content"},[a("el-row",{attrs:{gutter:0}},[a("el-col",{staticClass:"text-center",attrs:{span:24}},[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"table-func pull-left"},[a("el-button",{staticClass:"pull-right mt5",attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield_productType2}},[a("i",{staticClass:"icon-add"}),t._v(" "),a("font",[t._v("新建")])],1)],1),t._v(" "),a("el-form",{attrs:{inline:!0,model:t.formInline}},[a("el-form-item",{attrs:{label:"部门名称",prop:"DEPTID"}},[a("el-select",{attrs:{placeholder:"请选择部门"},on:{change:t.requestData},model:{value:t.formInline.DEPTID,callback:function(e){t.$set(t.formInline,"DEPTID",e)},expression:"formInline.DEPTID"}},t._l(t.Select_DEPTID,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.fullname}})}))],1)],1)],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"title clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("产品类别")]),t._v(" "),a("div",{staticClass:"columns pull-right",staticStyle:{width:"160px"}},[a("el-input",{attrs:{placeholder:"请输入产品类别名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),a("div",{staticClass:"text item"},[a("el-form",{ref:"productType2Form",staticClass:"el-radio__table",attrs:{model:t.productType2Form,"status-icon":"","inline-message":""}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.productType2Form.inspectionList.filter(function(e){return!t.search||e.TYPE.toLowerCase().includes(t.search.toLowerCase())}),"row-key":"ID",border:"",stripe:"",height:"250","highlight-current-row":"","default-sort":{prop:"productType2Form.inspectionList",order:"descending"}}},[a("el-table-column",{staticClass:"pl30",attrs:{label:"类别编号",sortable:"",width:"100",prop:"NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".NUM"}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"自动生成",disabled:!0},model:{value:e.row.NUM,callback:function(a){t.$set(e.row,"NUM",a)},expression:"scope.row.NUM"}}):a("span",{staticClass:"blue",on:{click:function(a){t.viewchildRow(e.row.ID,e.row.NUM)}}},[t._v(t._s(e.row.NUM))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类别名称",sortable:"",prop:"TYPE"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{attrs:{prop:"inspectionList."+e.$index+".TYPE",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?a("el-input",{attrs:{size:"small",placeholder:"请选择",disabled:!0},model:{value:e.row.TYPE,callback:function(a){t.$set(e.row,"TYPE",a)},expression:"scope.row.TYPE"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:function(a){t.addprobtn(e.row)}},slot:"append"})],1):a("span",[t._v(t._s(e.row.TYPE))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"iconOperation",fixed:"right",label:"操作",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isEditing?a("el-button",{attrs:{type:"text",id:"Edit",size:"medium"},on:{click:function(a){t.saveRow(e.row)}}},[a("i",{staticClass:"icon-check",attrs:{title:"保存"}})]):a("el-button",{attrs:{type:"text",size:"medium",title:"删除"},on:{click:function(a){t.deleteRow(e.row)}}},[a("i",{staticClass:"icon-trash red"})])]}}])})],1)],1)],1)])],1),t._v(" "),a("el-col",{staticClass:"v-resize",attrs:{span:6}},[a("product2child",{ref:"product2child",attrs:{parentIds:t.formInline.DEPTID},on:{parentMsd_product2:t.childMsd_product2}})],1),t._v(" "),a("el-col",{staticClass:"v-resize",attrs:{span:6}},[a("inspectionSta2child",{ref:"inspectionSta2child",attrs:{parentIds:t.formInline.DEPTID},on:{parentMsd_inspectionSta2:t.childMsd_inspectionSta2}})],1),t._v(" "),a("el-col",{staticClass:"v-resize",attrs:{span:6}},[a("inspectionPro2child",{ref:"inspectionPro2child",attrs:{parentIds:t.formInline.DEPTID},on:{parentMsd_inspectionPro2:t.childMsd_inspectionPro2}})],1)],1),t._v(" "),a("div",{staticClass:"el-collapse-item mt10 pt10 pb10",attrs:{"aria-expanded":"true",accordion:""}},[a("el-row",{attrs:{gutter:0}},[a("el-col",{attrs:{span:24}},[a("el-tabs",[a("el-tab-pane",{attrs:{label:"专业组"}},[a("professionGrochild",{ref:"professionGrochild",attrs:{parentIds:t.formInline.DEPTID}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"检验/检测方法"}},[a("inspectionMet2child",{ref:"inspectionMet2child",attrs:{parentIds:t.formInline.DEPTID}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"原始数据模板"}},[a("rawDataTem2child",{ref:"rawDataTem2child",attrs:{parentIds:t.formInline.DEPTID}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"检验/检测报告模板"}},[a("inspectionRepTem2child",{ref:"inspectionRepTem2child",attrs:{parentIds:t.formInline.DEPTID}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"检测仪器"}},[a("rawDataAssetchild",{ref:"rawDataAssetchild",attrs:{parentIds:t.formInline.DEPTID}})],1)],1)],1)],1)],1)],1)])]),t._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"选择基础数据——产品类别",height:"300px",visible:t.dialogVisible3,width:"80%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("div",{staticClass:"columns pull-right child-search"},[a("el-input",{attrs:{placeholder:"请输入类别名称"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.categoryList.filter(function(e){return!t.search||e.TYPE.toLowerCase().includes(t.search.toLowerCase())}),border:"",stripe:"",height:"300px","default-sort":{prop:"categoryList",order:"descending"}},on:{"selection-change":t.SelChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"类别编码",width:"155",sortable:"",prop:"NUM"}}),t._v(" "),a("el-table-column",{attrs:{label:"类别名称",sortable:"",prop:"TYPE"}}),t._v(" "),a("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{label:"机构",width:"185",sortable:"",prop:"DEPTIDDesc"}}),t._v(" "),a("el-table-column",{attrs:{label:"录入时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"修改时间",width:"120",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addproclass}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var U=a("VU/8")(y,$,!1,function(t){a("Lp3e")},"data-v-39fc1c5b",null);e.default=U.exports}});
//# sourceMappingURL=2.4e1c8f2e03a872fcf63c.js.map