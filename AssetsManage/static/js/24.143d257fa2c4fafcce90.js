webpackJsonp([24],{"7IFe":function(e,t){},GuXR:function(e,t,a){"use strict";(function(e){var i=a("QmSG"),s=a("GkRW"),l=a("hbvp"),r=a("h7vj"),o=a("VEhc"),n=a("lTUV"),d=a("jk2w");t.a={name:"instruments",components:{vheader:s.a,navs_header:r.a,navs_left:l.a,instrumentsmask:n.a,tableControle:o.a,reportmask:d.a},data:function(){return{reportData:{},loading:!1,loadSign:!0,commentArr:{},status:[{label:"启用",value:1},{label:"封存",value:2},{label:"报废",value:3}],basic_url:i.a.dev_url,dataUrl:"/api/api-user/users",searchData:{page:1,limit:10,A_NAME:"",VENDOR:"",KEEPER:"",STATE:"",OPTION_STATUS:""},checkedName:["设备编号","设备名称","型号","技术指标","制造商","出厂编号","价格（万元）","接受日期","启用日期","配置地址","接收状态","保管人","备注"],tableHeader:[{label:"设备编号",prop:"ASSETNUM"},{label:"设备名称",prop:"DESCRIPTION"},{label:"型号",prop:"MODEL"},{label:"技术指标",prop:"ASSET_KPI"},{label:"制造商",prop:"VENDOR"},{label:"出厂编号",prop:"FACTOR_NUM"},{label:"价格（万元）",prop:"A_PRICE"},{label:"接受日期",prop:"ACCEPT_DATE"},{label:"启用日期",prop:"S_DATE"},{label:"配置地址",prop:"C_ADDRESS"},{label:"接收状态",prop:"A_STATUS"},{label:"保管人",prop:"KEEPER"},{label:"备注",prop:"MEMO"}],companyId:"",deptId:"",selUser:[],assetList:[],search:!1,show:!1,down:!0,up:!1,isShow:!1,ismin:!0,fullHeight:document.documentElement.clientHeight-210+"px",searchList:{DESCRIPTION:"",VENDOR:"",KEEPER:"",STATE:"",OPTION_STATUS:""},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"children",label:"CLASSIFY_DESCRIPTION"},page:{currentPage:1,pageSize:20,totalCount:0},treeData:[]}},methods:{min3max:function(){e(".lefttree").hasClass("el-col-5")?(e(".lefttree").removeClass("el-col-5"),e(".lefttree").addClass("el-col-1"),e(".leftcont").removeClass("el-col-19"),e(".leftcont").addClass("el-col-23"),e(".icon-doubleok").removeClass("icon-double-angle-left"),e(".icon-doubleok").addClass("icon-double-angle-right")):(e(".lefttree").removeClass("el-col-1"),e(".lefttree").addClass("el-col-5"),e(".leftcont").removeClass("el-col-23"),e(".leftcont").addClass("el-col-19"),e(".icon-doubleok").removeClass("icon-double-angle-right"),e(".icon-doubleok").addClass("icon-double-angle-left")),this.ismin=!this.ismin},rowClass:function(e){e.row,e.rowIndex;return"text-align:center"},tableControle:function(e){this.checkedName=e},sizeChange:function(e){this.page.pageSize=e,this.requestData()},currentChange:function(e){this.page.currentPage=e,this.requestData()},searchinfo:function(e){this.page.currentPage=1,this.page.pageSize=20,this.requestData()},resetbtn:function(){this.searchList={DESCRIPTION:"",VENDOR:"",KEEPER:"",STATE:"",OPTION_STATUS:""},this.requestData()},openAddMgr:function(){this.$refs.child.visible()},modify:function(){0!=this.selUser.length?this.selUser.length>1?this.$message({message:"不可同时修改多条数据",type:"warning"}):this.$refs.child.detail():this.$message({message:"请您选择要修改的数据",type:"warning"})},view:function(e){this.$refs.child.view(e)},modestsearch:function(){this.search=!this.search,this.down=!this.down,this.up=!this.up},deluserinfo:function(){var e=this,t=this.selUser;if(0!=t.length){for(var a=this.basic_url+"/api-apps/app/asset/deletes",i=t,s=[],l=0;l<i.length;l++)s.push(i[l].ID);var r={ids:s.toString(",")};this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;e.$axios.delete(a,{params:r}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})}else this.$message({message:"请您选择要删除的数据",type:"warning"})},physicsDel:function(){var e=this,t=this.selUser;if(0!=t.length){for(var a=this.basic_url+"/api-apps/app/asset/deletes/physicsDel",i=t,s=[],l=0;l<i.length;l++)s.push(i[l].ID);var r={ids:s.toString(",")};this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;e.$axios.delete(a,{params:r}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})}else this.$message({message:"请您选择要删除的数据",type:"warning"})},importData:function(){},exportData:function(){var e=this.basic_url+"/api-apps/app/asset/exportExc?access_token="+sessionStorage.getItem("access_token"),t=new XMLHttpRequest;t.open("POST",e,!0),t.responseType="blob",t.setRequestHeader("client_type","DESKTOP_WEB"),t.onload=function(){if(200==this.status){var e=this.response,t=document.createElement("a"),a=URL.createObjectURL(e);t.href=a,t.download="asset.xls",t.click()}},t.send()},Printing:function(){},reportdata:function(){this.reportData.app=this.productType,this.$refs.reportChild.visible()},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},SelChange:function(e){this.selUser=e},requestData:function(e){var t=this;this.loading=!0;var a={page:this.page.currentPage,limit:this.page.pageSize,DESCRIPTION:this.searchList.DESCRIPTION,VENDOR:this.searchList.VENDOR,KEEPER:this.searchList.KEEPER,STATE:this.searchList.STATE,OPTION_STATUS:this.searchList.OPTION_STATUS},i=this.basic_url+"/api-apps/app/asset";this.$axios.get(i,{params:a}).then(function(e){t.page.totalCount=e.data.count;var a=Math.ceil(t.page.totalCount/t.page.pageSize);t.page.currentPage>=a?t.loadSign=!1:t.loadSign=!0,t.assetList=e.data.data,t.loading=!1}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})},getKey:function(){var e=this,t=this.basic_url+"/api-apps/app/assetClass/tree?tree_id=CLASSIFY_NUM&tree_pid=PARENT";this.$axios.get(t,{}).then(function(t){e.resourceData=t.data.datas,e.treeData=e.transformTree(e.resourceData)})},transformTree:function(t){for(var a=0;a<t.length;a++)t[a].name=t[a].fullname,!t[a].pid||e.isArray(t[a].subDepts)?t[a].iconClass="icon-file-normal":t[a].iconClass="icon-file-text",e.isArray(t[a].subDepts)&&(t[a].children=this.transformTree(t[a].subDepts));return t},loadMore:function(){var e=this,t=sessionStorage.getItem("up2down");if(this.loadSign){if("down"==t){if(this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return this.page.currentPage=Math.ceil(this.page.totalCount/this.page.pageSize),!1}else if(this.page.currentPage--,this.page.currentPage<1)return this.page.currentPage=1,!1;this.loadSign=!1,setTimeout(function(){e.loadSign=!0},1e3),this.requestData()}},handleNodeClick:function(e){},formatter:function(e,t){return e.enabled},childByValue:function(e){this.$refs.navsheader.showClick(e)},renderContent:function(e,t){var a=t.node,i=t.data;t.store;return e("span",[e("i",{class:i.iconClass}),e("span",[a.label])])}},mounted:function(){this.requestData(),this.getKey()}}}).call(t,a("7t+N"))},YrtB:function(e,t){},lTUV:function(e,t,a){"use strict";var i=a("vboa"),s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.show?a("div",{staticClass:"mask"}):e._e(),e._v(" "),e.show?a("div",{staticClass:"mask_divbg"},[a("div",{staticClass:"mask_div"},[a("div",{staticClass:"mask_title_div clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.addtitle,expression:"addtitle"}],staticClass:"mask_title"},[e._v("添加仪器和计量器具")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.modifytitle,expression:"modifytitle"}],staticClass:"mask_title"},[e._v("修改仪器和计量器具")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.viewtitle,expression:"viewtitle"}],staticClass:"mask_title"},[e._v("查看仪器和计量器具")]),e._v(" "),a("div",{staticClass:"mask_anniu"},[a("span",{staticClass:"mask_span mask_max",on:{click:e.toggle}},[a("i",{class:{"icon-maximization":e.isok1,"icon-restore":e.isok2}})]),e._v(" "),a("span",{staticClass:"mask_span",on:{click:e.close}},[a("i",{staticClass:"icon-close1"})])])]),e._v(" "),a("div",{staticClass:"mask_content"},[a("el-form",{ref:"dataInfo",staticClass:"demo-user",attrs:{model:e.dataInfo,rules:e.rules,"label-width":"100px"}},[a("div",{staticClass:"accordion"},[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"设备基本信息",name:"1"}},[a("el-row",{staticClass:"pb10",attrs:{gutter:20}},[a("el-col",{staticClass:"pull-right",attrs:{span:5}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataInfo.ASSETNUM,callback:function(t){e.$set(e.dataInfo,"ASSETNUM",t)},expression:"dataInfo.ASSETNUM"}},[a("template",{slot:"prepend"},[e._v("设备编号")])],2)],1)],1),e._v(" "),e._l(e.basicInfo,function(t){return a("el-form-item",{key:t.id,style:{width:t.width,display:t.displayType},attrs:{label:t.label,prop:t.prop}},["input"==t.type&&"A_PRICE"!=t.prop?a("el-input",{attrs:{type:t.type,disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e(),e._v(" "),"textarea"==t.type?a("el-input",{attrs:{type:t.type,disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e(),e._v(" "),"date"==t.type?a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e(),e._v(" "),"radio"==t.type?a("el-radio-group",{attrs:{disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}},e._l(t.opts,function(e){return a("el-radio",{key:e.id,attrs:{label:e.label}})})):e._e(),e._v(" "),"select"==t.type?a("el-select",{attrs:{clearable:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择",disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}},e._l(e.selectData,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.fullname}})})):e._e(),e._v(" "),"input"==t.type&&"A_PRICE"==t.prop?a("el-input",{attrs:{type:t.type,disabled:e.noedit,id:"cost"},on:{blur:e.handlePrice},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e()],1)})],2),e._v(" "),a("el-collapse-item",{attrs:{title:"设备保管人员情况",name:"2"}},e._l(e.keeperInfo,function(t){return a("el-form-item",{key:t.id,style:{width:t.width,display:t.displayType},attrs:{label:t.label,prop:t.prop}},["input"==t.type&&"KEEPER"==t.prop?a("el-input",{attrs:{type:t.type,disabled:!0},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}},[a("el-button",{attrs:{slot:"append",disabled:e.noedit,icon:"el-icon-search"},on:{click:e.addPeople},slot:"append"})],1):e._e(),e._v(" "),"input"==t.type&&"KEEPER"!=t.prop?a("el-input",{attrs:{type:t.type,disabled:e.noedit},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e()],1)})),e._v(" "),a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:e.modify,expression:"modify"}],attrs:{title:"设备溯源信息状态",name:"3"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":e.rowClass,fit:!0,data:e.pmRecordList,"row-key":"ID",border:"",stripe:"","max-height":"260","highlight-current-row":"highlight-current-row","default-sort":{prop:"pmRecordList",order:"descending"}}},[a("el-table-column",{attrs:{type:"index",sortable:"",label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RECORDNUM",label:"溯源记录编号",sortable:"",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"PM_DATE",label:"溯源日期",sortable:"",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"R_DESC",label:"溯源确认内容",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"R_CONCLUSION",label:"溯源确认结论",sortable:"",width:"200px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"STATUS",label:"溯源信息状态",sortable:"",width:"120px"}})],1)],1),e._v(" "),a("el-collapse-item",{attrs:{title:"文件",name:"4"}},[a("doc-table",{ref:"docTable",attrs:{docParm:e.docParm},on:{saveParent:e.save}})],1),e._v(" "),a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:!e.addtitle,expression:"!addtitle"}],attrs:{title:"其他",name:"5"}},[e._l(e.otherInfo,function(t){return"DEPARTMENT"==t.prop?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.dept,expression:"dept"}],key:t.id,style:{width:t.width,display:t.displayType},attrs:{label:t.label,prop:t.prop}},["DEPARTMENT"==t.prop?a("el-input",{attrs:{type:t.type,disabled:""},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}}):e._e()],1):e._e()}),e._v(" "),e._l(e.otherInfo,function(t){return a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.views,expression:"views"}],key:t.id,style:{width:t.width,display:t.displayType},attrs:{label:t.label,prop:t.prop}},[a("el-input",{attrs:{type:t.type,disabled:""},model:{value:e.dataInfo[t.prop],callback:function(a){e.$set(e.dataInfo,t.prop,a)},expression:"dataInfo[item.prop]"}})],1)})],2)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.noviews,expression:"noviews"}],staticClass:"el-dialog__footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAndUpdate("dataInfo")}}},[e._v("保存")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addtitle,expression:"addtitle"}],attrs:{type:"success"},on:{click:function(t){e.saveAndSubmit("dataInfo")}}},[e._v("保存并继续")]),e._v(" "),a("el-button",{on:{click:e.close}},[e._v("取消")])],1)])],1)]),e._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,visible:e.dialogVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",stripe:"","header-cell-style":e.rowClass,height:"400px","default-sort":{prop:"userList",order:"descending"}},on:{"selection-change":e.SelChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",sortable:"",width:"140px",prop:"username"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",sortable:"",width:"200px",prop:"nickname"}}),e._v(" "),a("el-table-column",{attrs:{label:"机构",sortable:"",width:"150px",prop:"deptName"}}),e._v(" "),a("el-table-column",{attrs:{label:"公司",sortable:"",prop:"companyName"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime",width:"100px",sortable:"",formatter:e.dateFormat}})],1),e._v(" "),a("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[10,20,30,40],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}}),e._v(" "),e.noviews?a("div",{staticClass:"el-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addpeoname()}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1):e._e()],1)],1):e._e()])},staticRenderFns:[]};var l=function(e){a("7IFe")},r=a("VU/8")(i.a,s,!1,l,null,null);t.a=r.exports},ufwq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("GuXR"),s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"headerbg"},[a("vheader"),e._v(" "),a("navs_header",{ref:"navsheader"})],1),e._v(" "),a("div",{staticClass:"contentbg"},[a("navs_left",{ref:"navleft",on:{childByValue:e.childByValue}}),e._v(" "),a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"fixed-table-toolbar clearfix"},[a("div",{staticClass:"bs-bars pull-left"},[a("div",{staticClass:"hidden-xs",attrs:{id:"roleTableToolbar",role:"group"}},[a("button",{staticClass:"btn btn-green",attrs:{type:"button",id:""},on:{click:e.openAddMgr}},[a("i",{staticClass:"icon-add"}),e._v("添加\r\n\t              \t\t\t ")]),e._v(" "),a("button",{staticClass:"btn btn-blue button-margin",attrs:{type:"button"},on:{click:e.modify}},[a("i",{staticClass:"icon-edit"}),e._v("修改\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-red button-margin",attrs:{type:"button"},on:{click:e.deluserinfo}},[a("i",{staticClass:"icon-trash"}),e._v("删除\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-red button-margin",attrs:{type:"button"},on:{click:e.physicsDel}},[a("i",{staticClass:"icon-trash"}),e._v("物理删除\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.importData}},[a("i",{staticClass:"icon-upload-cloud"}),e._v("导入\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.exportData}},[a("i",{staticClass:"icon-download-cloud"}),e._v("导出\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.reportdata}},[a("i",{staticClass:"icon-clipboard"}),e._v("报表\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.Printing}},[a("i",{staticClass:"icon-print"}),e._v("打印\r\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.modestsearch}},[a("i",{staticClass:"icon-search"}),e._v("高级查询\r\n\t\t\t\t\t    \t\t"),a("i",{directives:[{name:"show",rawName:"v-show",value:e.down,expression:"down"}],staticClass:"icon-arrow1-down"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.up,expression:"up"}],staticClass:"icon-arrow1-up"})])])]),e._v(" "),a("div",{staticClass:"columns columns-right btn-group pull-right"},[e._m(0),e._v(" "),a("tableControle",{ref:"tableControle",attrs:{tableHeader:e.tableHeader,checkedName:e.checkedName},on:{tableControle:e.tableControle}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.search,expression:"search"}]},[a("el-form",{attrs:{model:e.searchList,"label-width":"70px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:5}}),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"设备名称",prop:"DESCRIPTION"}},[a("el-input",{model:{value:e.searchList.DESCRIPTION,callback:function(t){e.$set(e.searchList,"DESCRIPTION",t)},expression:"searchList.DESCRIPTION"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"制造商",prop:"VENDOR"}},[a("el-input",{model:{value:e.searchList.VENDOR,callback:function(t){e.$set(e.searchList,"VENDOR",t)},expression:"searchList.VENDOR"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"保管人",prop:"KEEPER"}},[a("el-input",{model:{value:e.searchList.KEEPER,callback:function(t){e.$set(e.searchList,"KEEPER",t)},expression:"searchList.KEEPER"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticStyle:{"margin-top":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.searchinfo}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{"margin-top":"2px","margin-left":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.resetbtn}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:0}},[a("el-col",{staticClass:"lefttree",attrs:{span:5}},[a("div",{staticClass:"lefttreebg"},[a("div",{staticClass:"left_tree_title clearfix",on:{click:function(t){e.min3max()}}},[e.ismin?a("div",{staticClass:"pull-left pr20"},[e._v("设备分类")]):e._e(),e._v(" "),a("span",{staticClass:"pull-right navbar-minimalize minimalize-styl-2"},[a("i",{staticClass:"icon-doubleok icon-double-angle-left blue"})])]),e._v(" "),a("div",{staticClass:"left_treebg",style:{height:e.fullHeight}},[e.ismin?a("div",{staticClass:"p15"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.resourceData,"node-key":"id","default-expand-all":"",indent:22,"render-content":e.renderContent,props:e.resourceProps},on:{"node-click":e.handleNodeClick}})],1):e._e()])])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":e.rowClass,data:e.assetList,border:"",stripe:"",height:e.fullHeight,"default-sort":{prop:"assetList",order:"descending"},"element-loading-text":"加载中…","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.9)"},on:{"selection-change":e.SelChange}},[this.checkedName.length>0?a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"",align:"center"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("设备编号")?a("el-table-column",{attrs:{label:"设备编号",width:"130",sortable:"",prop:"ASSETNUM"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"blue",attrs:{title:"点击查看详情"},on:{click:function(a){e.view(t.row)}}},[e._v(e._s(t.row.ASSETNUM)+"\r\n\t\t\t\t\t\t\t\t\t")])]}}])}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("设备名称")?a("el-table-column",{attrs:{label:"设备名称",width:"200",sortable:"",prop:"DESCRIPTION"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("型号")?a("el-table-column",{attrs:{label:"型号",sortable:"",prop:"MODEL"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("技术指标")?a("el-table-column",{attrs:{label:"技术指标",width:"120",sortable:"",prop:"ASSET_KPI"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("制造商")?a("el-table-column",{attrs:{label:"制造商",width:"140",sortable:"",prop:"VENDOR"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("出厂编号")?a("el-table-column",{attrs:{label:"出厂编号",width:"160",sortable:"",prop:"FACTOR_NUM"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("价格(万元)")?a("el-table-column",{attrs:{label:"价格(万元)",width:"140",sortable:"",prop:"A_PRICE"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("接受日期")?a("el-table-column",{attrs:{label:"接受日期",width:"140",sortable:"",prop:"ACCEPT_DATE",formatter:e.dateFormat}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("启用日期")?a("el-table-column",{attrs:{label:"启用日期",width:"140",sortable:"",prop:"S_DATE",formatter:e.dateFormat}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("配置地址")?a("el-table-column",{attrs:{label:"配置地址",width:"140",sortable:"",prop:"C_ADDRESS"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("接收状态")?a("el-table-column",{attrs:{label:"接收状态",width:"120",sortable:"",prop:"A_STATUS"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("保管人")?a("el-table-column",{attrs:{label:"保管人",width:"200",sortable:"",prop:"KEEPER"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("备注")?a("el-table-column",{attrs:{label:"备注",width:"200",sortable:"",prop:"MEMO"}}):e._e()],1),e._v(" "),this.checkedName.length>0?a("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[10,20,30,40],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}}):e._e()],1)],1)],1)]),e._v(" "),a("instrumentsmask",{ref:"child",attrs:{detailData:e.selUser[0]},on:{request:e.requestData}}),e._v(" "),a("reportmask",{ref:"reportChild",attrs:{reportData:e.reportData}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btn btn-default btn-refresh",attrs:{id:"refresh",title:"刷新"}},[t("i",{staticClass:"icon-refresh"})])}]};var l=function(e){a("YrtB")},r=a("VU/8")(i.a,s,!1,l,"data-v-43321950",null);t.default=r.exports},vboa:function(e,t,a){"use strict";(function(e){var i=a("bOdI"),s=a.n(i),l=a("QmSG"),r=a("bZCE");t.a={name:"masks",props:["detailData"],components:{docTable:r.a},data:function(){var e;return e={loadSign:!0,commentArr:{},docParm:{model:"new",appname:"",recordid:1,userid:1,username:"",deptid:1,deptfullname:"",appid:1},rules:{ASSETNUM:[{required:!0,trigger:"blur",validator:this.Validators.isWorknumber}],DESCRIPTION:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],CONFIG_UNIT:[{required:!0,message:"必填",trigger:"change"}],INS_SITE:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],VENDOR:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],MODEL:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],ASSET_KPI:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],SUPPORT_ASSET:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}],OPTION_STATUS:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],ISMETER:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],ISPM:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],KEEPER:[{required:!0,trigger:"blur",validator:this.Validators.isChoosedata}],ACCEPT_DATE:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],USEDATE:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],S_DATE:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],C_ADDRESS:[{required:!0,message:"必填",trigger:"blur"},{trigger:"blur",validator:this.Validators.isSpecificKey}],MODE1:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],STATE:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],MODE:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],STATUS:[{required:!0,trigger:"blur",validator:this.Validators.isWorknumber}],A_STATUS:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],TYPE:[{required:!0,trigger:"change",validator:this.Validators.isChoosedata}],A_PRICE:[{required:!0,trigger:"blur",message:"必填"}],FACTOR_NUM:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}],SUPPLIER:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}],ACCEPT_NUM:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}],TECHNICAL_DATA:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}],MEMO:[{required:!1,trigger:"blur",validator:this.Validators.isSpecificKey}]},basicInfo:[{label:"设备价值",prop:"A_PRICE",width:"30%",type:"input",displayType:"inline-block"},{label:"设备名称",prop:"DESCRIPTION",width:"30%",type:"input",displayType:"inline-block"},{label:"接收日期",prop:"ACCEPT_DATE",width:"30%",type:"date",displayType:"inline-block"},{label:"设备型号",prop:"MODEL",width:"30%",type:"input",displayType:"inline-block"},{label:"配置单位",prop:"CONFIG_UNIT",width:"30%",type:"select",displayType:"inline-block"},{label:"使用日期",prop:"USEDATE",width:"30%",type:"date",displayType:"inline-block"},{label:"技术指标",prop:"ASSET_KPI",width:"100%",type:"textarea",displayType:"inline-block"},{label:"配套设备",prop:"SUPPORT_ASSET",width:"100%",type:"textarea",displayType:"inline-block"},{label:"制造单位",prop:"VENDOR",width:"30%",type:"input",displayType:"inline-block"},{label:"出厂编号",prop:"FACTOR_NUM",width:"30%",type:"input",displayType:"inline-block"},{label:"供货单位",prop:"SUPPLIER",width:"30%",type:"input",displayType:"inline-block"},{label:"验收单号",prop:"ACCEPT_NUM",width:"30%",type:"input",displayType:"inline-block"},{label:"使用状态",prop:"OPTION_STATUS",width:"30%",type:"input",displayType:"inline-block"},{label:"计量器具",prop:"ISMETER",width:"30%",type:"radio",displayType:"inline-block",opts:[{label:"是",val:"是"},{label:"否",val:"否"}]},{label:"需要溯源",prop:"ISPM",width:"30%",type:"radio",displayType:"inline-block",opts:[{label:"是",val:"是"},{label:"否",val:"否"}]},{label:"维护方式",prop:"MODE",width:"30%",type:"radio",displayType:"inline-block",opts:[{label:"外委",val:"外委"},{label:"自维",val:"自维"}]},{label:"检定/验证",prop:"MODE1",width:"30%",type:"radio",displayType:"inline-block",opts:[{label:"送检",val:"送检"},{label:"自检",val:"自检"}]},{label:"接收状态",prop:"A_STATUS",width:"70%",type:"radio",displayType:"inline-block",opts:[{label:"全新",val:"全新"},{label:"已使用过",val:"已使用过"},{label:"改装过",val:"改装过"},{label:"大修过",val:"大修过"}]},{label:"设备状态",prop:"STATE",width:"70%",type:"radio",opts:[{label:"启用",val:"1"},{label:"封存",val:"2"},{label:"报废",val:"3"}],displayType:"inline-block"},{label:"配置地址",prop:"C_ADDRESS",width:"100%",type:"textarea",displayType:"inline-block"},{label:"设备分类",prop:"TYPE",width:"30%",type:"radio",opts:[{label:"仪器",val:"仪器"},{label:"量具",val:"量具"}],displayType:"inline-block"},{label:"安装地点",prop:"INS_SITE",width:"30%",type:"input",displayType:"inline-block"},{label:"启用日期",prop:"S_DATE",width:"30%",type:"date",displayType:"inline-block"},{label:"技术资料",prop:"TECHNICAL_DATA",width:"100%",type:"textarea",displayType:"inline-block"}],keeperInfo:[{label:"设备保管人",prop:"KEEPER",width:"50%",type:"input",displayType:"inline-block"},{label:"备注",prop:"MEMO",width:"50%",type:"input",displayType:"inline-block"}],otherInfo:[{label:"录入人",prop:"ENTERBYDesc",width:"30%",type:"input",displayType:"inline-block"},{label:"录入时间",prop:"ENTERDATE",width:"30%",type:"input",displayType:"inline-block"},{label:"机构",prop:"DEPTIDDesc",width:"30%",type:"input",displayType:"inline-block"},{label:"修改人",prop:"CHANGEBYDesc",width:"30%",type:"input",displayType:"inline-block"},{label:"修改时间",prop:"CHANGEDATE",width:"30%",type:"date",displayType:"inline-block"}],basic_url:l.a.dev_url,show:!1,isok1:!0,isok2:!1,down:!0,up:!1,activeNames:["1","2","3","4"],modify:!1,resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"simplename"},selectData:[],getCheckboxData:{},dataInfo:{ID:"",ASSETNUM:"",DESCRIPTION:"",CONFIG_UNIT:"",INS_SITE:"",SUPPORT_ASSET:"",VENDOR:"",SUPPLIER:"",MODEL:"",FACTOR_NUM:"",ASSET_KPI:"",STATE:"",OPTION_STATUS:"",TYPE:"",ACCEPT_NUM:"",ISMETER:"",ISPM:"",STATUSDATE:"",KEEPER:"",ACCEPT_DATE:"",S_DATE:"",C_ADDRESS:"",A_STATUS:"",A_PRICE:"",MODE:"",MODE1:"",CHANGEBY:"",CHANGEDATE:"",ENTERBY:"",ENTERDATE:"",DEPTID:"",MEMO:"",STATUS:"1",SYNCHRONIZATION_TIME:""},pmRecordList:[],addtitle:!0,modifytitle:!1,viewtitle:!1,dept:!1,noedit:!1,views:!1,noviews:!0},s()(e,"modify",!1),s()(e,"hintshow",!1),s()(e,"statusshow1",!0),s()(e,"statusshow2",!1),s()(e,"falg",!1),s()(e,"dialogVisible",!1),s()(e,"userList",[]),s()(e,"page",{currentPage:1,pageSize:10,totalCount:0}),s()(e,"selectData",[]),e},methods:{rowClass:function(e){e.row,e.rowIndex;return"text-align:center"},handlePrice:function(){this.dataInfo.A_PRICE=parseFloat(this.dataInfo.A_PRICE).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),console.log(this.dataInfo.A_PRICE)},getCompany:function(){var e=this,t=this.basic_url+"/api-user/depts/treeByType";this.$axios.get(t,{params:{type:"2"}}).then(function(t){console.log(t.data),e.selectData=t.data})},addPeople:function(){console.log(123),this.getuserinfo(),this.dialogVisible=!0},addpeoname:function(){0==this.selUser.length?this.$message({message:"请选择数据",type:"warning"}):this.selUser.length>1?this.$message({message:"不可同时选择多条数据",type:"warning"}):(this.dataInfo.KEEPER=this.selUser[0].nickname,this.dialogVisible=!1,this.getuserinfo())},SelChange:function(e){this.selUser=e},loadMore:function(){var e=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){e.loadSign=!0},1e3),this.requestData()}},sizeChange:function(e){this.page.pageSize=e},currentChange:function(e){this.page.currentPage=e},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},getUser:function(e){var t=this,a=this.basic_url+"/api-user/users/currentMap";this.$axios.get(a,{}).then(function(a){"new"==e?(t.dataInfo.DEPTID=a.data.deptId,t.dataInfo.ENTERBY=a.data.id,t.dataInfo.ENTERDATE=t.getToday()):(t.dataInfo.DEPTID=a.data.deptId,t.dataInfo.CHANGEBY=a.data.id,t.dataInfo.CHANGEDATE=t.getToday()),t.docParm.userid=a.data.id,t.docParm.username=a.data.username,t.docParm.deptid=a.data.deptId,t.docParm.deptfullname=a.data.deptName}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})},getToday:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},getPmList:function(){var e=this,t={page:1,limit:20,assetnum:this.dataInfo.ASSETNUM},a=this.basic_url+"/api-apps/app/pmRecord";this.$axios.get(a,{params:t}).then(function(t){e.pmRecordList=t.data.data}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},visible:function(){this.addtitle=!0,this.modifytitle=!1,this.viewtitle=!1,this.dept=!1,this.noedit=!1,this.views=!1,this.noviews=!0,this.modify=!1,this.hintshow=!1,this.statusshow1=!0,this.statusshow2=!1,this.show=!0,this.docParm={model:"new",appname:"仪器和计量器具",recordid:1,appid:47},this.getUser("new")},detail:function(e){this.dataInfo=this.detailData,this.dataInfo.CONFIG_UNIT=Number(this.dataInfo.CONFIG_UNIT),this.handlePrice(),this.addtitle=!1,this.modifytitle=!0,this.viewtitle=!1,this.dept=!0,this.noedit=!1,this.views=!1,this.noviews=!0,this.modify=!0,this.hintshow=!1,this.statusshow1=!0,this.statusshow2=!1,this.getUser();var t=this;setTimeout(function(){t.docParm.model="edit",t.docParm.appname="仪器和计量器具",t.docParm.recordid=t.dataInfo.ID,t.docParm.appid=47,t.$refs.docTable.getData()},100),this.show=!0},view:function(e){this.addtitle=!1,this.modifytitle=!1,this.viewtitle=!0,this.dept=!1,this.modify=!0,this.noedit=!0,this.views=!0,this.mview=!0,this.noviews=!1,this.dataInfo=e,this.show=!0;var t=this;setTimeout(function(){t.docParm.model="view",t.docParm.appname="仪器和计量器具",t.docParm.recordid=t.dataInfo.ID,t.docParm.appid=47,t.$refs.docTable.getData()},100)},close:function(){this.reset(),this.$emit("request"),this.show=!1},reset:function(){this.dataInfo={ID:"",ASSETNUM:"",DESCRIPTION:"",CONFIG_UNIT:"",INS_SITE:"",SUPPORT_ASSET:"",VENDOR:"",SUPPLIER:"",MODEL:"",FACTOR_NUM:"",ASSET_KPI:"",STATE:"",OPTION_STATUS:"",TYPE:"",ACCEPT_NUM:"",ISMETER:"",ISPM:"",STATUSDATE:"",KEEPER:"",ACCEPT_DATE:"",S_DATE:"",C_ADDRESS:"",A_STATUS:"",A_PRICE:"",MODE:"",MODE1:"",CHANGEBY:"",CHANGEDATE:"",ENTERBY:"",ENTERDATE:"",DEPARTMENT:"",MEMO:"",STATUS:"1",SYNCHRONIZATION_TIME:""}},toggle:function(e){this.isok1?this.maxDialog():this.rebackDialog()},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},maxDialog:function(t){this.isok1=!1,this.isok2=!0,e(".mask_div").width(document.body.clientWidth),e(".mask_div").height(document.body.clientHeight-60),e(".mask_div").css("top","60px")},rebackDialog:function(){this.isok1=!0,this.isok2=!1,e(".mask_div").css("width","80%"),e(".mask_div").css("height","80%"),e(".mask_div").css("top","100px")},save:function(e){var t=this,a=this,i=this.basic_url+"/api-apps/app/asset/saveOrUpdate";this.$refs.dataInfo.validate(function(s){s||"docUpload"!=e||t.$message({message:"请先正确填写信息，再进行文档上传",type:"warning"}),s?(t.$axios.post(i,a.dataInfo).then(function(a){0==a.data.resp_code&&("docUpload"==e?(t.docParm.recordid=a.data.datas.id,t.docParm.model="edit",t.$refs.docTable.autoLoad(),t.dataInfo.ID=a.data.datas.id):(t.$message({message:"保存成功",type:"success"}),t.$emit("request"),t.reset()))}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),t.falg=!0):(t.show=!0,t.$message({message:"未填写完整，请填写",type:"warning"}),t.falg=!1)})},saveAndUpdate:function(e){this.save(e),this.falg&&(this.show=!1)},saveAndSubmit:function(e){this.save(e),this.show=!0},getuserinfo:function(){var e=this,t={page:this.page.currentPage,limit:this.page.pageSize};this.$axios.get(this.basic_url+"/api-user/users?deptId="+this.dataInfo.CONFIG_UNIT,{params:t}).then(function(t){e.page.totalCount=t.data.count;var a=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=a?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var i=[],s=1;s<=a;s++)if(void 0!==e.commentArr[s]&&e.commentArr[s].length>0)for(var l=0;l<e.commentArr[s].length;l++)i.push(e.commentArr[s][l]);e.userList=i}).catch(function(e){})}},mounted:function(){this.getCompany()}}}).call(t,a("7t+N"))}});
//# sourceMappingURL=24.143d257fa2c4fafcce90.js.map