webpackJsonp([39],{"8zml":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("bOdI"),i=a.n(s),r=a("QmSG"),o=a("GkRW"),n=a("h7vj"),l=a("hbvp"),c=a("nxpL"),d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.show?a("div",{staticClass:"mask"}):e._e(),e._v(" "),e.show?a("div",{staticClass:"mask_divbg"},[a("div",{staticClass:"mask_div"},[a("div",{staticClass:"mask_title_div clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.addtitle,expression:"addtitle"}],staticClass:"mask_title"},[e._v("添加报告审批")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.modifytitle,expression:"modifytitle"}],staticClass:"mask_title"},[e._v("修改报告审批")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.viewtitle,expression:"viewtitle"}],staticClass:"mask_title"},[e._v("查看报告审批")]),e._v(" "),a("div",{staticClass:"mask_anniu"},[a("span",{staticClass:"mask_span mask_max",on:{click:e.toggle}},[a("i",{class:{"icon-maximization":e.isok1,"icon-restore":e.isok2}})]),e._v(" "),a("span",{staticClass:"mask_span",on:{click:e.close}},[a("i",{staticClass:"icon-close1"})])])]),e._v(" "),a("div",{staticClass:"mask_content"},[a("el-form",{ref:"report",staticClass:"demo-adduserForm",attrs:{model:e.report,"inline-message":"",rules:e.rules,"label-width":"100px"}},[a("div",{staticClass:"accordion",attrs:{id:"information"}},[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"报告审批",name:"1"}},[a("el-row",{staticClass:"pb10"},[a("el-col",{staticClass:"pull-right",attrs:{span:3}},[a("el-input",{attrs:{disabled:!0},model:{value:e.report.STATEDesc,callback:function(t){e.$set(e.report,"STATEDesc",t)},expression:"report.STATEDesc"}},[a("template",{slot:"prepend"},[e._v("状态")])],2)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"编码",prop:"REPORTNUM"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.REPORTNUM,callback:function(t){e.$set(e.report,"REPORTNUM",t)},expression:"report.REPORTNUM"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"报告描述",prop:"DESCRIPTION"}},[a("el-input",{attrs:{disabled:e.noedit},model:{value:e.report.DESCRIPTION,callback:function(t){e.$set(e.report,"DESCRIPTION",t)},expression:"report.DESCRIPTION"}})],1)],1)],1)],1),e._v(" "),a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:e.views,expression:"views"}],attrs:{title:"其它",name:"2"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录入人",prop:"ENTERBYDesc"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.ENTERBYDesc,callback:function(t){e.$set(e.report,"ENTERBYDesc",t)},expression:"report.ENTERBYDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录入时间",prop:"ENTERDATE"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.ENTERDATE,callback:function(t){e.$set(e.report,"ENTERDATE",t)},expression:"report.ENTERDATE"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"机构",prop:"DEPTIDDesc"}},[a("el-input",{attrs:{disabled:e.edit},model:{value:e.report.DEPTIDDesc,callback:function(t){e.$set(e.report,"DEPTIDDesc",t)},expression:"report.DEPTIDDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"修改人",prop:"CHANGEBYDesc"}},[a("el-input",{attrs:{placeholder:"当前修改人",disabled:e.edit},model:{value:e.report.CHANGEBYDesc,callback:function(t){e.$set(e.report,"CHANGEBYDesc",t)},expression:"report.CHANGEBYDesc"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"修改时间",prop:"CHANGEDATE"}},[a("el-input",{attrs:{placeholder:"当前修改时间",disabled:e.edit},model:{value:e.report.CHANGEDATE,callback:function(t){e.$set(e.report,"CHANGEDATE",t)},expression:"report.CHANGEDATE"}})],1)],1)],1)],1),e._v(" "),a("el-collapse-item",{attrs:{title:"文件",name:"2"}},[a("doc-table",{ref:"docTable",attrs:{docParm:e.docParm},on:{saveParent:e.save,showLoading:e.showLoading,closeLoading:e.closeLoading}})],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.noviews,expression:"noviews"}],staticClass:"el-dialog__footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAndUpdate()}}},[e._v("保存")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.addtitle,expression:"addtitle"}],attrs:{type:"success"},on:{click:function(t){e.saveAndSubmit()}}},[e._v("保存并继续")]),e._v(" "),a("el-button",{on:{click:e.close}},[e._v("取消")])],1)])],1)])]):e._e()])},staticRenderFns:[]};var p=function(e){a("L95m")},h=a("VU/8")(c.a,d,!1,p,"data-v-10fac074",null).exports,u=a("VEhc"),m=a("jk2w"),v={name:"reportachiving",components:{vheader:o.a,navs_left:l.a,navs_header:n.a,reportapprovemask:h,tableControle:u.a,reportmask:m.a},data:function(){var e;return e={reportData:{},loading:!1,basic_url:r.a.dev_url,loadSign:!0,commentArr:{}},i()(e,"loading",!1),i()(e,"value",""),i()(e,"options",[{value:"1",label:"活动"},{value:"0",label:"不活动"}]),i()(e,"checkedName",["编码","报告描述","流程状态"]),i()(e,"tableHeader",[{label:"编码",prop:"REPORTNUM"},{label:"报告描述",prop:"DESCRIPTION"},{label:"流程状态",prop:"STATE"}]),i()(e,"selUser",[]),i()(e,"USESEAL",[]),i()(e,"search",!1),i()(e,"show",!1),i()(e,"down",!0),i()(e,"up",!1),i()(e,"isShow",!1),i()(e,"ismin",!0),i()(e,"fullHeight",document.documentElement.clientHeight-210+"px"),i()(e,"searchList",{REPORTNUM:"",DESCRIPTION:""}),i()(e,"resourceData",[]),i()(e,"resourceDialogisShow",!1),i()(e,"resourceCheckedKey",[]),i()(e,"page",{currentPage:1,pageSize:10,totalCount:0}),e},methods:{rowClass:function(e){e.row,e.rowIndex;return"text-align:center"},loadMore:function(){var e=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){e.loadSign=!0},1e3),this.requestData()}},tableControle:function(e){this.checkedName=e},sizeChange:function(e){this.page.pageSize=e,this.requestData()},currentChange:function(e){this.page.currentPage=e,this.requestData()},resetbtn:function(){this.searchList={REPORTNUM:"",DESCRIPTION:""},this.requestData()},searchinfo:function(e){this.page.currentPage=1,this.page.pageSize=10,this.requestData()},openAddMgr:function(){this.$refs.reportapprove.visible()},modify:function(){0!=this.selUser.length?this.selUser.length>1?this.$message({message:"不可同时修改多个数据",type:"warning"}):(console.log(this.selUser[0]),this.$refs.reportapprove.detail(this.selUser[0].ID)):this.$message({message:"请您选择要修改的数据",type:"warning"})},view:function(e){this.$refs.reportapprove.view(e)},modestsearch:function(){this.search=!this.search,this.down=!this.down,this.up=!this.up},reportdata:function(){this.reportData.app=this.productType,this.$refs.reportChild.visible()},deluserinfo:function(){var e=this,t=this.selUser;if(0!=t.length){for(var a=this.basic_url+"/api-apps/app/reportApprove/deletes",s=t,i=[],r=0;r<s.length;r++)i.push(s[r].ID);var o={ids:i.toString(",")};this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;e.$axios.delete(a,{params:o}).then(function(t){0==t.data.resp_code&&(e.$message({message:"删除成功",type:"success"}),e.requestData())}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})}else this.$message({message:"请您选择要删除的数据",type:"warning"})},importData:function(){},exportData:function(){},Printing:function(){},Configuration:function(){this.$router.push({path:"/inspection_project"})},judge:function(e){e.STATUS="1"==e.STATUS?"活动":"不活动"},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},SelChange:function(e){this.selUser=e},requestData:function(e){var t=this;this.loading=!0;var a={page:this.page.currentPage,limit:this.page.pageSize,REPORTNUM:this.searchList.REPORTNUM,DESCRIPTION:this.searchList.DESCRIPTION},s=this.basic_url+"/api-apps/app/reportApprove";this.$axios.get(s,{params:a}).then(function(e){t.page.totalCount=e.data.count;var a=Math.ceil(t.page.totalCount/t.page.pageSize);t.page.currentPage>=a?t.loadSign=!1:t.loadSign=!0,t.commentArr[t.page.currentPage]=e.data.data;for(var s=[],i=1;i<=a;i++)if(void 0!==t.commentArr[i]&&t.commentArr[i].length>0)for(var r=0;r<t.commentArr[i].length;r++)s.push(t.commentArr[i][r]);t.USESEAL=s,t.loading=!1}).catch(function(e){})},handleNodeClick:function(e){},formatter:function(e,t){return e.enabled},childByValue:function(e){this.$refs.navsheader.showClick(e)}},mounted:function(){this.requestData()}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"headerbg"},[a("vheader"),e._v(" "),a("navs_header",{ref:"navsheader"})],1),e._v(" "),a("div",{staticClass:"contentbg"},[a("navs_left",{ref:"navleft",on:{childByValue:e.childByValue}}),e._v(" "),a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"fixed-table-toolbar clearfix"},[a("div",{staticClass:"bs-bars pull-left"},[a("div",{staticClass:"hidden-xs",attrs:{id:"roleTableToolbar",role:"group"}},[a("button",{staticClass:"btn btn-green",attrs:{type:"button",id:""},on:{click:e.openAddMgr}},[a("i",{staticClass:"icon-add"}),e._v("添加\n                                ")]),e._v(" "),a("button",{staticClass:"btn btn-blue button-margin",attrs:{type:"button"},on:{click:e.modify}},[a("i",{staticClass:"icon-edit"}),e._v("修改\n                                ")]),e._v(" "),a("button",{staticClass:"btn btn-red button-margin",attrs:{type:"button"},on:{click:e.deluserinfo}},[a("i",{staticClass:"icon-trash"}),e._v("删除\n                                ")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.reportdata}},[a("i",{staticClass:"icon-clipboard"}),e._v("报表\n\t\t\t\t\t\t\t")]),e._v(" "),a("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:e.modestsearch}},[a("i",{staticClass:"icon-search"}),e._v("高级查询\n                                    "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.down,expression:"down"}],staticClass:"icon-arrow1-down"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.up,expression:"up"}],staticClass:"icon-arrow1-up"})])])]),e._v(" "),a("div",{staticClass:"columns columns-right btn-group pull-right"},[e._m(0),e._v(" "),a("tableControle",{ref:"tableControle",attrs:{tableHeader:e.tableHeader,checkedName:e.checkedName},on:{tableControle:e.tableControle}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.search,expression:"search"}]},[a("el-form",{attrs:{model:e.searchList}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"编码",prop:"REPORTNUM","label-width":"45px"}},[a("el-input",{model:{value:e.searchList.REPORTNUM,callback:function(t){e.$set(e.searchList,"REPORTNUM",t)},expression:"searchList.REPORTNUM"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"报告描述",prop:"DESCRIPTION","label-width":"80px"}},[a("el-input",{model:{value:e.searchList.DESCRIPTION,callback:function(t){e.$set(e.searchList,"DESCRIPTION",t)},expression:"searchList.DESCRIPTION"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticStyle:{"margin-top":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.searchinfo}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{"margin-top":"2px","margin-left":"2px"},attrs:{type:"primary",size:"small"},on:{click:e.resetbtn}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:0}},[a("el-col",{attrs:{span:24}},[a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":e.rowClass,data:e.USESEAL,border:"",stripe:"",height:e.fullHeight,"default-sort":{prop:"USESEAL",order:"descending"},"element-loading-text":"加载中…","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.9)"},on:{"selection-change":e.SelChange}},[this.checkedName.length>0?a("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("编码")?a("el-table-column",{attrs:{label:"编码",width:"155",sortable:"",prop:"REPORTNUM"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"blue",attrs:{title:"点击查看详情"},on:{click:function(a){e.view(t.row)}}},[e._v(e._s(t.row.REPORTNUM)+"\n\t\t\t\t\t\t\t\t\t\t")])]}}])}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("报告描述")?a("el-table-column",{attrs:{label:"报告描述",sortable:"",prop:"DESCRIPTION"}}):e._e(),e._v(" "),-1!=this.checkedName.indexOf("流程状态")?a("el-table-column",{attrs:{label:"流程状态",sortable:"",prop:"STATE"}}):e._e()],1),e._v(" "),this.checkedName.length>0?a("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[10,20,30,40,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}}):e._e()],1)],1)],1)]),e._v(" "),a("reportapprovemask",{ref:"reportapprove",attrs:{page:e.page},on:{request:e.requestData}}),e._v(" "),a("reportmask",{ref:"reportChild",attrs:{reportData:e.reportData}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btn btn-default btn-refresh",attrs:{id:"refresh",title:"刷新"}},[t("i",{staticClass:"icon-refresh"})])}]};var f=a("VU/8")(v,g,!1,function(e){a("PUhy")},"data-v-67e77116",null);t.default=f.exports},L95m:function(e,t){},PUhy:function(e,t){},nxpL:function(e,t,a){"use strict";(function(e){var s=a("QmSG"),i=a("bZCE");t.a={name:"masks",components:{docTable:i.a},data:function(){return{falg:!1,basic_url:s.a.dev_url,selUser:[],edit:!0,show:!1,docParm:{model:"new",recordid:1,userid:1,username:"",deptid:1,deptfullname:"",appname:"",appid:1},isok1:!0,isok2:!1,down:!0,up:!1,activeNames:["1","2"],dialogVisible:!1,selectData:[],rules:{NUM:[{required:!1,trigger:"change",validator:function(e,t,a){""!=t&&0==/^[0-9a-zA-Z()（）]+$/.test(t)?a(new Error("请填写数字、字母或括号（编码不填写可自动生成）")):a()}}],TYPE:[{required:!0,trigger:"blur",validator:function(e,t,a){""===t?a(new Error("请填写产品类别名称")):1==/^[!@#$%^&*";',.~！@#￥%……&*《》？，。?、|]+$/.test(t)?a(new Error("请规范填写名称")):a()}}]},resourceData:[],category:{},addtitle:!0,modifytitle:!1,viewtitle:!1,dept:!1,noedit:!1,views:!1,noviews:!0,modify:!1,hintshow:!1,statusshow1:!0,statusshow2:!1,report:{ID:"",REPORTNUM:"",DESCRIPTION:"",WONUMID:"",STATUS:"1",STATE:"1",STATEDesc:"草稿"}}},methods:{showLoading:function(){this.loading=!0},closeLoading:function(){this.loading=!1},SelChange:function(e){this.selUser=e},visible:function(){var e=this;this.reset(),this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){e.report.DEPTID=t.data.deptId,e.report.ENTERBY=t.data.id;var a=new Date;e.report.ENTERDATE=e.$moment(a).format("YYYY-MM-DD"),e.docParm={model:"new",appname:"报告归档",recordid:1,appid:91},e.docParm.userid=t.data.id,e.docParm.username=t.data.username,e.docParm.deptid=t.data.deptId,e.docParm.deptfullname=t.data.deptName}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),this.addtitle=!0,this.modifytitle=!1,this.viewtitle=!1,this.dept=!1,this.noedit=!1,this.views=!1,this.noviews=!0,this.modify=!1,this.hintshow=!1,this.statusshow1=!0,this.statusshow2=!1,this.show=!0},detail:function(e){var t=this;this.addtitle=!1,this.modifytitle=!0,this.viewtitle=!1,this.dept=!0,this.noedit=!1,this.views=!1,this.noviews=!0,this.hintshow=!1,this.modify=!0,this.statusshow1=!1,this.statusshow2=!0,this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(e){t.report.DEPTID=e.data.deptId,t.report.CHANGEBY=e.data.id;var a=new Date;t.report.CHANGEDATE=t.$moment(a).format("YYYY-MM-DD"),t.docParm.userid=e.data.id,t.docParm.username=e.data.username,t.docParm.deptid=e.data.deptId,t.docParm.deptfullname=e.data.deptName;var s=t;setTimeout(function(){s.docParm.model="edit",s.docParm.appname="报告归档/检测标准",s.docParm.recordid=s.report.id,s.docParm.appid=91,s.$refs.docTable.getData()},100)}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})});var a=this.basic_url+"/api-apps/app/reportApprove/"+e;this.$axios.get(a,{}).then(function(e){t.report=e.data,t.show=!0}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),this.show=!0},view:function(e){this.report=e,this.addtitle=!1,this.modifytitle=!1,this.viewtitle=!0,this.dept=!0,this.noedit=!0,this.views=!0,this.noviews=!1,this.show=!0},close:function(){this.show=!1,this.$emit("request")},open:function(){this.show=!0},toggle:function(e){1==this.isok1?this.maxDialog():this.rebackDialog()},maxDialog:function(t){this.isok1=!1,this.isok2=!0,e(".mask_div").width(document.body.clientWidth),e(".mask_div").height(document.body.clientHeight-60),e(".mask_div").css("top","60px")},rebackDialog:function(){this.isok1=!0,this.isok2=!1,e(".mask_div").css("width","80%"),e(".mask_div").css("height","80%"),e(".mask_div").css("top","100px")},save:function(e){var t=this;this.$refs.report.validate(function(a){if(a||"docUpload"!=e||t.$message({message:"请先正确填写信息，再进行文档上传",type:"warning"}),a){var s=t.basic_url+"/api-apps/app/reportApprove/saveOrUpdate";t.$axios.post(s,t.report).then(function(a){0==a.data.resp_code?"docUpload"==e?(t.docParm.recordid=a.data.datas.id,t.docParm.model="edit",t.$refs.docTable.autoLoad(),t.report.id=a.data.datas.id):(t.$message({message:"保存成功",type:"success"}),t.$emit("request")):(t.show=!0,1==a.data.resp_code&&(""!=a.data.resp_msg?t.$message({message:a.data.resp_msg,type:"warning"}):t.$message({message:"相同数据不可重复添加！",type:"warning"})))}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),t.falg=!0}else t.show=!0,t.$message({message:"未填写完整，请填写",type:"warning"}),t.falg=!1})},saveAndUpdate:function(){this.save(),this.falg&&(this.show=!1)},saveAndSubmit:function(){this.save(),this.show=!0,this.reset()},reset:function(){this.report={ID:"",REPORTNUM:"",DESCRIPTION:"",WONUMID:"",STATUS:"1",STATE:"1",STATEDesc:"草稿"}},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":this.$moment(a).format("YYYY-MM-DD")},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})}},mounted:function(){}}}).call(t,a("7t+N"))}});
//# sourceMappingURL=39.5bbe2216e6f143507a92.js.map