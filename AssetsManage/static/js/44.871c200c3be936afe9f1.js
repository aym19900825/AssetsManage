webpackJsonp([44],{"8B4d":function(t,e,s){"use strict";(function(t){var a,i=s("bOdI"),o=s.n(i),r=s("mvHQ"),n=s.n(r),l=s("QmSG");e.a={name:"masks",data:function(){var t=this;return{testing_projectForm:{CHANGEBY:"",CHILD_FIELD:"",DEPARTMENT:"",DOCLINKS_NUM:"",ENTERBY:"",ENTERDATE:"",FIELD:"",ID:"",P_NAME:"",P_NUM:"",QUALIFICATION:"",QUALIFICATIONList:[],QUANTITY:"",STATUS:"1",VERSION:1,WORK_INSTRUCTIONList:[]},falg:!1,basic_url:l.a.dev_url,editSearch:"",value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],edit:!0,show:!1,isok1:!0,isok2:!1,down:!0,up:!1,activeNames:["1","2","3"],dialogVisible:!1,rules:{P_NUM:[{required:!1,trigger:"change",validator:function(t,e,s){""!=e&&0==/^[0-9a-zA-Z()（）]+$/.test(e)?s(new Error("请填写数字、字母或括号（编码不填写可自动生成）")):s()}}],P_NAME:[{required:!0,trigger:"blur",validator:function(t,e,s){""===e?s(new Error("请填写项目名称")):s()}}],QUANTITY:[{required:!0,trigger:"blur",validator:function(t,e,s){""===e?s(new Error("请填写数字")):s()}}],QUALIFICATION:[{required:!0,trigger:"blur",validator:function(t,e,s){""===e?s(new Error("请填写人员资质")):s()}}],DOCLINKS_NUM:[{required:!0,validator:function(e,s,a){console.log(t.testing_projectForm.DOCLINKS_NUM),""===t.testing_projectForm.DOCLINKS_NUM?a(new Error("请选择作业指导书")):a()}}],UNITCOST:[{required:!1,trigger:"change",validator:function(t,e,s){console.log(e),""!=e&&void 0!=e&&0==/^(-)?\d{1,3}(,\d{3})*(.\d+)?$/.test(e)?s(new Error("请输入数字")):s()}}]},gridData:[],selval:[],loadSign:!0,commentArr:{},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"simplename"},page:{currentPage:1,pageSize:10,totalCount:0},TESTING_PROJECTFORM:{},addtitle:!0,modifytitle:!1,viewtitle:!1,dept:!1,noedit:!1,views:!1,noviews:!0,modify:!1,hintshow:!1,statusshow1:!0,statusshow2:!1,dialogVisible2:!1,WORK_INSTRUCTIONList:[],fullHeight:document.documentElement.clientHeight-210+"px",isEditing:!0,peoplegrid:""}},methods:(a={addfield:function(){this.testing_projectForm.QUALIFICATIONList.push({ID:"",STEP:"",C_NUM:"",C_NAME:"",C_DATE:"",isEditing:!0})},deleteRow:function(t,e){e.splice(t,1)},iconOperation:function(t,e,s,a){"iconOperation"===e.property&&(t.isEditing=!t.isEditing)},dateFormat:function(t,e){var s=t[e.property];return void 0==s?"":this.$moment(s).format("YYYY-MM-DD HH:mm:ss")},rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},hint:function(){this.hintshow=!0},hinthide:function(){this.hintshow=!1},toNum:function(t){return t.replace(/\,|\￥/g,"")},toPrice:function(){var t=document.getElementById("cost").value,e=parseFloat(this.toNum(t)).toFixed(2).toString().split(".");e[0]=e[0].replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1,"),this.testing_projectForm.UNITCOST=e.join(".")},getCompany:function(){var t=this;this.editSearch="DOCLINKS";var e=this.basic_url+"/api-user/depts/type";this.$axios.get(e,{}).then(function(e){t.resourceData=e.data.data})},loadMore:function(){var t=this;if(this.loadSign){if(this.loadSign=!1,this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return;setTimeout(function(){t.loadSign=!0},1e3),this.requestData()}},getwork:function(){this.dialogVisible2=!0},getCheckedNodes:function(){this.checkedNodes=this.$refs.tree.getCheckedNodes()},confirms:function(){this.getCheckedNodes(),this.dialogVisible=!1,"DOCLINKS"==this.editSearch&&(this.testing_projectForm.DOCLINKSId=this.checkedNodes[0].id,this.testing_projectForm.DOCLINKS_NUM=this.checkedNodes[0].simplename)},SelChange:function(t){this.selval=t},sizeChange:function(t){this.page.pageSize=t,this.requestData()},currentChange:function(t){this.page.currentPage=t,this.requestData()},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},visible:function(){var t=this;this.testing_projectForm={CHANGEBY:"",CHILD_FIELD:"",DEPARTMENT:"",DOCLINKS_NUM:"",ENTERBY:"",ENTERDATE:"",FIELD:"",ID:"",P_NAME:"",P_NUM:"",QUALIFICATION:"",QUALIFICATIONList:[],QUANTITY:"",STATUS:"1",VERSION:1,WORK_INSTRUCTIONList:[]},this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(e){t.testing_projectForm.DEPARTMENT="",t.testing_projectForm.DEPTID=e.data.deptId,t.testing_projectForm.ENTERBY=e.data.id;var s=new Date;t.testing_projectForm.ENTERDATE=t.$moment(s).format("YYYY-MM-DD HH:mm:ss")}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})}),this.addtitle=!0,this.modifytitle=!1,this.viewtitle=!1,this.dept=!1,this.noedit=!1,this.views=!1,this.noviews=!0,this.modify=!1,this.hintshow=!1,this.statusshow1=!0,this.statusshow2=!1},detail:function(t){var e=this;this.$axios.get(this.basic_url+"/api-user/users/currentMap",{}).then(function(t){console.log(t.data),e.testing_projectForm.DEPARTMENT="",e.testing_projectForm.DEPTID=t.data.deptId,e.testing_projectForm.CHANGEBY=t.data.id;var s=new Date;e.testing_projectForm.CHANGEDATE=e.$moment(s).format("YYYY-MM-DD");var a=n()(e.testing_projectForm);e.TESTING_PROJECTFORM=JSON.parse(a)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})});var s=this.basic_url+"/api-apps/app/inspectionPro/"+t;this.$axios.get(s,{}).then(function(t){for(var s=0;s<t.data.QUALIFICATIONList.length;s++)t.data.QUALIFICATIONList[s].isEditing=!1;e.testing_projectForm=t.data}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),this.addtitle=!1,this.modifytitle=!0,this.viewtitle=!1,this.dept=!0,this.noedit=!1,this.views=!1,this.noviews=!0,this.hintshow=!1,this.modify=!0,this.statusshow1=!1,this.statusshow2=!0,this.show=!0},view:function(t){var e=this,s=this.basic_url+"/api-apps/app/inspectionPro/"+t;this.$axios.get(s,{}).then(function(t){e.testing_projectForm=t.data}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})}),this.addtitle=!1,this.modifytitle=!1,this.viewtitle=!0,this.dept=!0,this.noedit=!0,this.views=!0,this.noviews=!1,this.show=!0},update:function(t){var e=this;console.log(this.testing_projectForm);var s={ID:this.testing_projectForm.ID};this.$axios.get(this.basic_url+"/api-apps/app/inspectionPro/operate/updateRelate",{params:s}).then(function(t){console.log(t),console.log(t.data.resp_code),0==t.data.resp_code&&e.$message({message:"更新成功",type:"success"})}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},modifyversion:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var s=n()(e.TESTING_PROJECTFORM);if(n()(e.testing_projectForm)==s)return e.$message({message:"没有修改内容，不允许修订",type:"warning"}),!1;var a=e.basic_url+"/api-apps/app/inspectionPro/operate/upgraded";e.$axios.post(a,e.testing_projectForm).then(function(t){0==t.data.resp_code&&(e.$message({message:"保存成功",type:"success"}),e.show=!1,e.$emit("request"),e.$emit("reset"))}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})}else e.$message({message:"未填写完整，请填写",type:"warning"})})},close:function(){this.show=!1,this.$emit("request")},open:function(){this.show=!0},toggle:function(t){1==this.isok1?this.maxDialog():this.rebackDialog()},maxDialog:function(e){this.isok1=!1,this.isok2=!0,t(".mask_div").width(document.body.clientWidth),t(".mask_div").height(document.body.clientHeight-60),t(".mask_div").css("top","60px")},rebackDialog:function(){this.isok1=!0,this.isok2=!1,t(".mask_div").css("width","80%"),t(".mask_div").css("height","80%"),t(".mask_div").css("top","100px")},save:function(t){var e=this,s=this;this.$refs[t].validate(function(t){if(t){e.testing_projectForm.STATUS="1"==s.testing_projectForm.STATUS||"活动"==e.testing_projectForm.STATUS?"1":"0";var a=e.basic_url+"/api-apps/app/inspectionPro/saveOrUpdate";e.$axios.post(a,s.testing_projectForm).then(function(t){0==t.data.resp_code?(e.$message({message:"保存成功",type:"success"}),e.$emit("reset"),e.$emit("request"),e.visible()):(e.show=!0,1==t.data.resp_code&&(""!=t.data.resp_msg?e.$message({message:t.data.resp_msg,type:"warning"}):e.$message({message:"相同数据不可重复添加！",type:"warning"})))}).catch(function(t){e.show=!0,e.$message({message:"网络错误，请重试",type:"error"})}),e.falg=!0}else e.show=!0,e.$message({message:"未填写完整，请填写",type:"warning"}),e.falg=!1})},saveAndUpdate:function(t){this.save(t),this.falg&&(this.show=!1)},saveAndSubmit:function(t){this.save(t),this.show=!0},getpepole:function(t){var e=this;console.log(0xd4372533a8d6),console.log(t),this.peoplegrid=t;var s=this.basic_url+"/api-user/users/qualifications";this.$axios.get(s,{}).then(function(t){e.page.totalCount=t.data.count,e.gridData=t.data.data,e.dialogVisible=!0})},dailogconfirm:function(){0==this.selval.length?this.$message({message:"请选择数据",type:"warning"}):this.selval.length>1?this.$message({message:" 不可选择多条数据",type:"warning"}):(console.log(111111),this.peoplegrid.C_NAME=this.selval[0].c_name,this.dialogVisible=!1)},addwork:function(){console.log(this.selval.length),0==this.selval.length?this.$message({message:"请选择数据",type:"warning"}):this.selval.length>1?this.$message({message:"不可以同时选择多条数据",type:"warning"}):(this.dialogVisible2=!1,this.testing_projectForm.DOCLINKS_NUM=this.selval[0].DESCRIPTION)}},o()(a,"handleClose",function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})}),o()(a,"requestData",function(t){var e=this,s={page:this.page.currentPage,limit:this.page.pageSize},a=this.basic_url+"/api-apps/app/workIns";this.$axios.get(a,{params:s}).then(function(t){e.page.totalCount=t.data.count;var s=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=s?e.loadSign=!1:e.loadSign=!0,e.commentArr[e.page.currentPage]=t.data.data;for(var a=[],i=1;i<=s;i++)if(void 0!==e.commentArr[i]&&e.commentArr[i].length>0)for(var o=0;o<e.commentArr[i].length;o++)a.push(e.commentArr[i][o]);e.WORK_INSTRUCTIONList=a}).catch(function(t){})}),a),mounted:function(){this.requestData(),this.getCompany()}}}).call(e,s("7t+N"))},PFSN:function(t,e){},TXOh:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("QmSG"),i=s("GkRW"),o=s("hbvp"),r=s("h7vj"),n=s("VEhc"),l=s("8B4d"),c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.show?s("div",{staticClass:"mask"}):t._e(),t._v(" "),t.show?s("div",{staticClass:"mask_divbg"},[s("div",{staticClass:"mask_div"},[s("div",{staticClass:"mask_title_div clearfix"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.addtitle,expression:"addtitle"}],staticClass:"mask_title"},[t._v("添加检验/检测项目")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.modifytitle,expression:"modifytitle"}],staticClass:"mask_title"},[t._v("修改检验/检测项目")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.viewtitle,expression:"viewtitle"}],staticClass:"mask_title"},[t._v("查看检验/检测项目")]),t._v(" "),s("div",{staticClass:"mask_anniu"},[s("span",{staticClass:"mask_span mask_max",on:{click:t.toggle}},[s("i",{class:{"icon-maximization":t.isok1,"icon-restore":t.isok2}})]),t._v(" "),s("span",{staticClass:"mask_span",on:{click:t.close}},[s("i",{staticClass:"icon-close1"})])])]),t._v(" "),s("div",{staticClass:"mask_content"},[s("el-form",{ref:"testing_projectForm",attrs:{"inline-message":"",model:t.testing_projectForm,rules:t.rules}},[s("div",{staticClass:"accordion"},[s("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"基本信息",name:"1"}},[s("el-row",{staticClass:"pb10",attrs:{gutter:20}},[s("el-col",{staticClass:"pull-right",attrs:{span:3}},[s("el-input",{attrs:{placeholder:"自动生成",disabled:!0},model:{value:t.testing_projectForm.VERSION,callback:function(e){t.$set(t.testing_projectForm,"VERSION",e)},expression:"testing_projectForm.VERSION"}},[s("template",{slot:"prepend"},[t._v("版本")])],2)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"编码",prop:"P_NUM","label-width":"100px"}},[s("el-input",{attrs:{disabled:t.noedit},model:{value:t.testing_projectForm.P_NUM,callback:function(e){t.$set(t.testing_projectForm,"P_NUM",e)},expression:"testing_projectForm.P_NUM"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:16}},[s("el-form-item",{attrs:{label:"项目名称",prop:"P_NAME","label-width":"100px"}},[s("el-input",{attrs:{onmouseover:"this.title=this.value",disabled:t.noedit},model:{value:t.testing_projectForm.P_NAME,callback:function(e){t.$set(t.testing_projectForm,"P_NAME",e)},expression:"testing_projectForm.P_NAME"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"单价(元)",prop:"UNITCOST","label-width":"100px"}},[s("el-input",{attrs:{id:"cost",disabled:t.noedit},on:{blur:t.toPrice},model:{value:t.testing_projectForm.UNITCOST,callback:function(e){t.$set(t.testing_projectForm,"UNITCOST",e)},expression:"testing_projectForm.UNITCOST"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"作业指导书",prop:"DOCLINKS_NUM","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.DOCLINKS_NUM,callback:function(e){t.$set(t.testing_projectForm,"DOCLINKS_NUM",e)},expression:"testing_projectForm.DOCLINKS_NUM"}},[s("el-button",{attrs:{slot:"append",icon:"icon-search",disabled:t.noedit},on:{click:t.getwork},slot:"append"})],1)],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"领域",prop:"FIELD","label-width":"100px"}},[s("el-input",{attrs:{disabled:t.noedit},model:{value:t.testing_projectForm.FIELD,callback:function(e){t.$set(t.testing_projectForm,"FIELD",e)},expression:"testing_projectForm.FIELD"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"子领域",prop:"CHILD_FIELD","label-width":"100px"}},[s("el-input",{attrs:{disabled:t.noedit},model:{value:t.testing_projectForm.CHILD_FIELD,callback:function(e){t.$set(t.testing_projectForm,"CHILD_FIELD",e)},expression:"testing_projectForm.CHILD_FIELD"}})],1)],1),t._v(" "),t.dept?s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"机构",prop:"DEPTIDDesc","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.DEPTIDDesc,callback:function(e){t.$set(t.testing_projectForm,"DEPTIDDesc",e)},expression:"testing_projectForm.DEPTIDDesc"}})],1)],1):t._e()],1)],1),t._v(" "),s("el-collapse-item",{attrs:{title:"人员资质",name:"2"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.noviews,expression:"noviews"}],staticClass:"table-func"},[s("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:t.addfield}},[s("i",{staticClass:"icon-add"}),t._v(" "),s("font",[t._v("新建行")])],1)],1),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,fit:!0,data:t.testing_projectForm.QUALIFICATIONList,"row-key":"ID",border:"",stripe:"","max-height":"260","highlight-current-row":"highlight-current-row","default-sort":{prop:"testing_projectForm.QUALIFICATIONList",order:"descending"}},on:{"cell-click":t.iconOperation}},[t.viewtitle?t._e():s("el-table-column",{attrs:{prop:"iconOperation",fixed:"",width:"50px"},scopedSlots:t._u([{key:"default",fn:function(t){return[t.row.isEditing?s("i",{staticClass:"el-icon-check"}):s("i",{staticClass:"el-icon-edit"})]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"STEP",label:"序号",sortable:"",width:"120px","label-width":"150px",type:"index"}}),t._v(" "),s("el-table-column",{attrs:{prop:"C_NAME",label:"证书名称",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-form-item",{attrs:{prop:"QUALIFICATIONList."+e.$index+".C_NAME",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[e.row.isEditing?s("el-input",{attrs:{size:"small",placeholder:"请输入证书名称"},model:{value:e.row.C_NAME,callback:function(s){t.$set(e.row,"C_NAME",s)},expression:"scope.row.C_NAME"}},[s("el-button",{attrs:{slot:"append",icon:"icon-search",disabled:t.noedit},on:{click:function(s){t.getpepole(e.row)}},slot:"append"})],1):s("span",[t._v(t._s(e.row.C_NAME))])],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.viewtitle,expression:"!viewtitle"}],attrs:{type:"text",size:"small"},nativeOn:{click:function(s){s.preventDefault(),t.deleteRow(e.$index,t.testing_projectForm.QUALIFICATIONList)}}},[s("i",{staticClass:"icon-trash red"})])]}}])})],1)],1),t._v(" "),s("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:t.views,expression:"views"}],attrs:{title:"其他",name:"3"}},[s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"录入人",prop:"ENTERBYDesc","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.ENTERBYDesc,callback:function(e){t.$set(t.testing_projectForm,"ENTERBYDesc",e)},expression:"testing_projectForm.ENTERBYDesc"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"录入时间",prop:"ENTERDATE","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.ENTERDATE,callback:function(e){t.$set(t.testing_projectForm,"ENTERDATE",e)},expression:"testing_projectForm.ENTERDATE"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"修改人",prop:"CHANGEBYDesc","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.CHANGEBYDesc,callback:function(e){t.$set(t.testing_projectForm,"CHANGEBYDesc",e)},expression:"testing_projectForm.CHANGEBYDesc"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"修改时间",prop:"CHANGEDATE","label-width":"100px"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.testing_projectForm.CHANGEDATE,callback:function(e){t.$set(t.testing_projectForm,"CHANGEDATE",e)},expression:"testing_projectForm.CHANGEDATE"}})],1)],1)],1)],1)],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.noviews,expression:"noviews"}],staticClass:"el-dialog__footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.saveAndUpdate("testing_projectForm")}}},[t._v("保存")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.addtitle,expression:"addtitle"}],attrs:{type:"success"},on:{click:function(e){t.saveAndSubmit("testing_projectForm")}}},[t._v("保存并继续")]),t._v(" "),t.modify?s("el-button",{staticClass:"btn-primarys",attrs:{type:"primary"},on:{click:function(e){t.modifyversion("testing_projectForm")}}},[t._v("修订")]):t._e(),t._v(" "),s("el-button",{on:{click:t.close}},[t._v("取消")])],1)])],1)]),t._v(" "),s("el-dialog",{attrs:{"modal-append-to-body":!1,visible:t.dialogVisible,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-table",{attrs:{data:t.gridData,height:"400px"},on:{"selection-change":t.SelChange}},[s("el-table-column",{attrs:{type:"selection",width:"55",fixed:""}}),t._v(" "),s("el-table-column",{attrs:{label:"证书名称",sortable:"",width:"200px",prop:"c_name"}}),t._v(" "),s("el-table-column",{attrs:{label:"资质有效期",sortable:"",prop:"c_date"}})],1),t._v(" "),s("el-pagination",{staticClass:"pull-right",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}}),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dailogconfirm()}}},[t._v("确 定")])],1)],1),t._v(" "),s("el-dialog",{attrs:{"modal-append-to-body":!1,title:"作业指导书",visible:t.dialogVisible2,width:"80%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible2=e}}},[s("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.WORK_INSTRUCTIONList,border:"",stripe:"",height:t.fullHeight,"default-sort":{prop:"WORK_INSTRUCTIONList",order:"descending"}},on:{"selection-change":t.SelChange}},[s("el-table-column",{attrs:{type:"selection",fixed:"",width:"55",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"分发号",width:"155",sortable:"",prop:"NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",{staticClass:"blue",attrs:{title:"点击查看详情"},on:{click:function(s){t.view(e.row)}}},[t._v(t._s(e.row.NUM)+"\n\t\t\t\t\t\t\t\t\t\t\t")])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"文件名称",sortable:"",prop:"DESCRIPTION"}}),t._v(" "),s("el-table-column",{attrs:{label:"版本",width:"100",sortable:"",prop:"VERSION",align:"right"}}),t._v(" "),s("el-table-column",{attrs:{label:"录入时间",width:"120",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}),t._v(" "),s("el-table-column",{attrs:{label:"机构",width:"120",prop:"DEPTIDDesc",sortable:""}})],1),t._v(" "),s("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40,100],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}}),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible2=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.addwork}},[t._v("确 定")])],1)],1)],1):t._e()])},staticRenderFns:[]};var p=function(t){s("PFSN")},d=s("VU/8")(l.a,c,!1,p,null,null).exports,h={name:"testing_projects",components:{vheader:i.a,navs_left:o.a,navs_header:r.a,tableControle:n.a,projectmask:d},data:function(){return{loading:!1,basic_url:a.a.dev_url,value:"",options:[{value:"1",label:"活动"},{value:"0",label:"不活动"}],loadSign:!0,commentArr:{},checkedName:["编码","名称","单价","领域","子领域","版本","机构","录入时间","修改时间"],tableHeader:[{label:"编码",prop:"P_NUM"},{label:"名称",prop:"P_NAME"},{label:"单价",prop:"UNITCOST"},{label:"领域",prop:"FIELD"},{label:"子领域",prop:"CHILD_FIELD"},{label:"版本",prop:"VERSION"},{label:"机构",prop:"DEPTIDDesc"},{label:"录入时间",prop:"ENTERDATE"},{label:"修改时间",prop:"CHANGEDATE"}],selMenu:[],"活动":!0,"不活动":!1,projectList:[],search:!1,show:!1,down:!0,up:!1,isShow:!1,ismin:!0,fullHeight:document.documentElement.clientHeight-210+"px",searchList:{P_NUM:"",P_NAME:"",VERSION:"",DEPTID:""},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"simplename"},page:{currentPage:1,pageSize:20,totalCount:0},testing_projectForm:{},selectData:[]}},methods:{rowClass:function(t){t.row,t.rowIndex;return"text-align:center"},getCompany:function(){var t=this,e=this.basic_url+"/api-user/depts/treeByType";this.$axios.get(e,{params:{type:"2"}}).then(function(e){console.log(e.data),t.selectData=e.data})},loadMore:function(){var t=this,e=sessionStorage.getItem("up2down");if(console.log(e),console.log(this.loadSign),this.loadSign){if("down"==e){if(this.page.currentPage++,this.page.currentPage>Math.ceil(this.page.totalCount/this.page.pageSize))return this.page.currentPage=Math.ceil(this.page.totalCount/this.page.pageSize),!1}else if(this.page.currentPage--,this.page.currentPage<1)return this.page.currentPage=1,!1;this.loadSign=!1,console.log("this.page.currentPage",this.page.currentPage),setTimeout(function(){t.loadSign=!0},1e3),this.requestData()}},tableControle:function(t){this.checkedName=t},sizeChange:function(t){this.page.pageSize=t,this.requestData()},currentChange:function(t){this.page.currentPage=t,this.requestData()},resetbtn:function(){this.searchList={P_NUM:"",P_NAME:"",VERSION:"",DEPTID:""},this.requestData()},searchinfo:function(t){this.page.currentPage=1,this.page.pageSize=10,this.requestData()},reset:function(){this.testing_projectForm={VERSION:"1",STATUS:"活动",P_NUM:"",P_NAME:"",QUANTITY:"",QUALIFICATION:"",FIELD:"",CHILD_FIELD:"",DOCLINKS_NUM:"",DEPT:"",ENTERBY:"",ENTERDATE:"",CHANGEBY:"",CHANGEDATE:""},void 0!==this.$refs.testing_projectForm&&this.$refs.testing_projectForm.resetFields()},openAddMgr:function(){this.reset(),this.$refs.child.open(),this.$refs.child.visible()},modify:function(){0!=this.selMenu.length?this.selMenu.length>1?this.$message({message:"不可同时修改多条数据",type:"warning"}):(console.log("===="+this.selMenu[0].ID),this.testing_projectForm=this.selMenu[0],this.$refs.child.detail(this.selMenu[0].ID)):this.$message({message:"请您选择要修改的数据",type:"warning"})},view:function(t){this.$refs.child.view(t)},modestsearch:function(){this.search=!this.search,this.down=!this.down,this.up=!this.up},deluserinfo:function(){var t=this,e=this.selMenu;if(0!=e.length){for(var s=this.basic_url+"/api-apps/app/inspectionPro/deletes",a=e,i=[],o=0;o<a.length;o++)i.push(a[o].ID);var r={ids:i.toString(",")};this.$confirm("确定删除此数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){e.value;t.$axios.delete(s,{params:r}).then(function(e){0==e.data.resp_code&&(t.$message({message:"删除成功",type:"success"}),t.requestData())}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})}).catch(function(){})}else this.$message({message:"请您选择要删除的数据",type:"warning"})},importData:function(){},exportData:function(){var t=this.basic_url+"/api-apps/app/inspectionPro/exportExc?access_token="+sessionStorage.getItem("access_token"),e=new XMLHttpRequest;e.open("POST",t,!0),e.responseType="blob",e.setRequestHeader("client_type","DESKTOP_WEB"),e.onload=function(){if(200==this.status){var t=this.response,e=document.createElement("a"),s=URL.createObjectURL(t);e.href=s,e.download="inspectionPro.xls",e.click()}},e.send()},Printing:function(){},dateFormat:function(t,e){var s=t[e.property];return void 0==s?"":this.$moment(s).format("YYYY-MM-DD")},SelChange:function(t){this.selMenu=t},requestData:function(t){var e=this;this.loading=!0;var s={page:this.page.currentPage,limit:this.page.pageSize,P_NUM:this.searchList.P_NUM,P_NAME:this.searchList.P_NAME,VERSION:this.searchList.VERSION,DEPTID:this.searchList.DEPTID},a=this.basic_url+"/api-apps/app/inspectionPro";this.$axios.get(a,{params:s}).then(function(t){e.page.totalCount=t.data.count;var s=Math.ceil(e.page.totalCount/e.page.pageSize);e.page.currentPage>=s?e.loadSign=!1:e.loadSign=!0,e.projectList=t.data.data,e.loading=!1}).catch(function(t){})},handleNodeClick:function(t){},formatter:function(t,e){return t.enabled},childByValue:function(t){this.$refs.navsheader.showClick(t)}},mounted:function(){this.requestData(),this.getCompany()}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"headerbg"},[s("vheader"),t._v(" "),s("navs_header",{ref:"navsheader"})],1),t._v(" "),s("div",{staticClass:"contentbg"},[s("navs_left",{ref:"navleft",on:{childByValue:t.childByValue}}),t._v(" "),s("div",{staticClass:"wrapper wrapper-content"},[s("div",{staticClass:"ibox-content"},[s("div",{staticClass:"fixed-table-toolbar clearfix"},[s("div",{staticClass:"bs-bars pull-left"},[s("div",{staticClass:"hidden-xs",attrs:{id:"roleTableToolbar",role:"group"}},[s("button",{staticClass:"btn btn-green",attrs:{type:"button"},on:{click:t.openAddMgr}},[s("i",{staticClass:"icon-add"}),t._v("添加\r\n\t              \t\t\t ")]),t._v(" "),s("button",{staticClass:"btn btn-blue button-margin",attrs:{type:"button"},on:{click:t.modify}},[s("i",{staticClass:"icon-edit"}),t._v("修改\r\n\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-red button-margin",attrs:{type:"button"},on:{click:t.deluserinfo}},[s("i",{staticClass:"icon-trash"}),t._v("删除\r\n\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:t.importData}},[s("i",{staticClass:"icon-upload-cloud"}),t._v("导入\r\n\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:t.exportData}},[s("i",{staticClass:"icon-download-cloud"}),t._v("导出\r\n\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:t.Printing}},[s("i",{staticClass:"icon-print"}),t._v("打印\r\n\t\t\t\t\t\t\t")]),t._v(" "),s("button",{staticClass:"btn btn-primarys button-margin",attrs:{type:"button"},on:{click:t.modestsearch}},[s("i",{staticClass:"icon-search"}),t._v("高级查询\r\n\t\t\t\t\t    \t\t"),s("i",{directives:[{name:"show",rawName:"v-show",value:t.down,expression:"down"}],staticClass:"icon-arrow1-down"}),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:t.up,expression:"up"}],staticClass:"icon-arrow1-up"})])])]),t._v(" "),s("div",{staticClass:"columns columns-right btn-group pull-right"},[t._m(0),t._v(" "),s("tableControle",{ref:"tableControle",attrs:{tableHeader:t.tableHeader,checkedName:t.checkedName},on:{tableControle:t.tableControle}})],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.search,expression:"search"}]},[s("el-form",{attrs:{model:t.searchList,"label-width":"45px"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"编码",prop:"P_NUM"}},[s("el-input",{model:{value:t.searchList.P_NUM,callback:function(e){t.$set(t.searchList,"P_NUM",e)},expression:"searchList.P_NUM"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"名称",prop:"P_NAME"}},[s("el-input",{model:{value:t.searchList.P_NAME,callback:function(e){t.$set(t.searchList,"P_NAME",e)},expression:"searchList.P_NAME"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:4}},[s("el-form-item",{attrs:{label:"版本",prop:"VERSION"}},[s("el-input",{model:{value:t.searchList.VERSION,callback:function(e){t.$set(t.searchList,"VERSION",e)},expression:"searchList.VERSION"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{label:"机构",prop:"DEPTID"}},[s("el-select",{attrs:{clearable:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},model:{value:t.searchList.DEPTID,callback:function(e){t.$set(t.searchList,"DEPTID",e)},expression:"searchList.DEPTID"}},t._l(t.selectData,function(t,e){return s("el-option",{key:e,attrs:{value:t.id,label:t.fullname}})}))],1)],1),t._v(" "),s("el-col",{attrs:{span:4}},[s("el-button",{staticStyle:{"margin-top":"2px"},attrs:{type:"primary",size:"small"},on:{click:t.searchinfo}},[t._v("搜索")]),t._v(" "),s("el-button",{staticStyle:{"margin-top":"2px","margin-left":"2px"},attrs:{type:"primary",size:"small"},on:{click:t.resetbtn}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),s("el-row",{attrs:{gutter:0}},[s("el-col",{attrs:{span:24}},[s("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadMore,expression:"loadMore"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":t.rowClass,data:t.projectList,border:"",stripe:"",height:t.fullHeight,"default-sort":{prop:"projectList",order:"descending"},"element-loading-text":"加载中…","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.9)"},on:{"selection-change":t.SelChange}},[this.checkedName.length>0?s("el-table-column",{attrs:{type:"selection",width:"55",fixed:"",align:"center"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("编码")?s("el-table-column",{attrs:{label:"编码",width:"150",sortable:"",prop:"P_NUM"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",{staticClass:"blue",attrs:{title:"点击查看详情"},on:{click:function(s){t.view(e.row.ID)}}},[t._v(t._s(e.row.P_NUM)+"\r\n\t\t\t\t\t\t\t\t\t")])]}}])}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("名称")?s("el-table-column",{attrs:{label:"名称",width:"220",sortable:"",prop:"P_NAME"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("单价")?s("el-table-column",{attrs:{label:"单价(元)",width:"120",align:"right",sortable:"",prop:"UNITCOST"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("领域")?s("el-table-column",{attrs:{label:"领域",width:"120",sortable:"",prop:"FIELD"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("子领域")?s("el-table-column",{attrs:{label:"子领域",width:"120",sortable:"",prop:"CHILD_FIELD"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("版本")?s("el-table-column",{attrs:{label:"版本",width:"70",sortable:"",prop:"VERSION",align:"right"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("机构")?s("el-table-column",{attrs:{label:"机构",width:"180",sortable:"",prop:"DEPTIDDesc"}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("录入时间")?s("el-table-column",{attrs:{label:"录入时间",width:"100",prop:"ENTERDATE",sortable:"",formatter:t.dateFormat}}):t._e(),t._v(" "),-1!=this.checkedName.indexOf("修改时间")?s("el-table-column",{attrs:{label:"修改时间",width:"100",prop:"CHANGEDATE",sortable:"",formatter:t.dateFormat}}):t._e()],1),t._v(" "),this.checkedName.length>0?s("el-pagination",{staticClass:"pull-right pt10",attrs:{background:"","current-page":t.page.currentPage,"page-sizes":[10,20,30,40,100],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next",total:t.page.totalCount},on:{"size-change":t.sizeChange,"current-change":t.currentChange}}):t._e()],1)],1)],1)]),t._v(" "),s("projectmask",{ref:"child",attrs:{page:t.page},on:{request:t.requestData,reset:t.reset}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"btn btn-default btn-refresh",attrs:{id:"refresh",title:"刷新"}},[e("i",{staticClass:"icon-refresh"})])}]};var g=s("VU/8")(h,u,!1,function(t){s("g7dJ")},"data-v-56aab27a",null);e.default=g.exports},g7dJ:function(t,e){}});
//# sourceMappingURL=44.871c200c3be936afe9f1.js.map