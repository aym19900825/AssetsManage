webpackJsonp([53],{CLxh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("a98I"),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"headerbg"},[a("vheader"),e._v(" "),a("navs_header")],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"contentbg"},[a("div",{staticClass:"navbar-default navbar-static-side"},[a("div",{attrs:{id:"sidebar-collapse"}},[a("div",{staticClass:"navbarbg"},[a("span",{staticClass:"navbar-minimalize minimalize-styl-2",on:{click:function(t){e.min2max()}}},[a("i",{staticClass:"icon-menu1"})])]),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"navs",attrs:{id:"side-menu"}},e._l(e.leftNavs,function(t,s){return a("li",{key:s},[a("router-link",{attrs:{to:t.navherf}},[a("i",{class:t.navicon}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.ismin,expression:"ismin"}],staticClass:"nav-label"},[e._v(e._s(t.navtitle))])])],1)}))])]),e._v(" "),a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox-content",style:{height:e.fullHeight}},[a("el-form",{ref:"personinfo",attrs:{model:e.personinfo,rules:e.rules,"label-width":"80px","label-position":e.labelPosition}},[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"账号设置",name:"1"}},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{disabled:""},model:{value:e.personinfo.username,callback:function(t){e.$set(e.personinfo,"username",t)},expression:"personinfo.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"nickname"}},[a("el-input",{model:{value:e.personinfo.nickname,callback:function(t){e.$set(e.personinfo,"nickname",t)},expression:"personinfo.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号",prop:"worknumber"}},[a("el-input",{model:{value:e.personinfo.worknumber,callback:function(t){e.$set(e.personinfo,"worknumber",t)},expression:"personinfo.worknumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"password",disabled:""},model:{value:e.personinfo.password,callback:function(t){e.$set(e.personinfo,"password",t)},expression:"personinfo.password"}},[a("el-button",{attrs:{slot:"append",icon:"icon-edit"},on:{click:e.editpassword},slot:"append"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"职务",prop:"post"}},[a("el-input",{model:{value:e.personinfo.post,callback:function(t){e.$set(e.personinfo,"post",t)},expression:"personinfo.post"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"入职日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.personinfo.workdate,callback:function(t){e.$set(e.personinfo,"workdate",t)},expression:"personinfo.workdate"}})],1)],1),e._v(" "),a("el-col",{staticClass:"pt30",attrs:{span:8}},[a("form",{staticStyle:{float:"right",width:"100%"},attrs:{method:"post",id:"file",action:"",enctype:"multipart/form-data"}},[a("el-button",{staticClass:"a-upload",staticStyle:{width:"100%",position:"relative"},attrs:{type:"warn",round:""}},[e.headImgUrl?a("img",{staticClass:"avatar",attrs:{src:e.headImgUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("input",{attrs:{id:"excelFile",type:"file",name:"uploadFile"},on:{change:e.upload}})])],1)])],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},["admin"===e.personinfo.username?a("el-form-item",{attrs:{label:"所属机构",prop:"deptName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.personinfo.deptName,callback:function(t){e.$set(e.personinfo,"deptName",t)},expression:"personinfo.deptName"}},[a("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:e.getDept},slot:"append"})],1)],1):a("el-form-item",{attrs:{label:"所属机构",prop:"deptName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.personinfo.deptName,callback:function(t){e.$set(e.personinfo,"deptName",t)},expression:"personinfo.deptName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"角色",prop:"roleId","label-width":"100px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.personinfo.roleId,callback:function(t){e.$set(e.personinfo,"roleId",t)},expression:"personinfo.roleId"}},e._l(e.selectData,function(e){return a("el-option",{key:e.name,attrs:{value:e.id,label:e.name}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"最高学历"}},[a("el-input",{attrs:{disabled:""},model:{value:e.personinfo.education,callback:function(t){e.$set(e.personinfo,"education",t)},expression:"personinfo.education"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"允许登录",prop:"islogin","label-width":"100px"}},[a("el-radio-group",{model:{value:e.personinfo.islogin,callback:function(t){e.$set(e.personinfo,"islogin",t)},expression:"personinfo.islogin"}},[a("el-radio",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("否")])],1)],1)],1)],1)],1),e._v(" "),a("el-collapse-item",{attrs:{title:"基本资料",name:"2"}},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"身份证号",prop:"idnumber"}},[a("el-input",{model:{value:e.personinfo.idnumber,callback:function(t){e.$set(e.personinfo,"idnumber",t)},expression:"personinfo.idnumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{model:{value:e.personinfo.sex,callback:function(t){e.$set(e.personinfo,"sex",t)},expression:"personinfo.sex"}},[a("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("女")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{model:{value:e.personinfo.phone,callback:function(t){e.$set(e.personinfo,"phone",t)},expression:"personinfo.phone"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"出生日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.personinfo.birthday,callback:function(t){e.$set(e.personinfo,"birthday",t)},expression:"personinfo.birthday"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[a("el-input",{model:{value:e.personinfo.telephone,callback:function(t){e.$set(e.personinfo,"telephone",t)},expression:"personinfo.telephone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[a("el-input",{model:{value:e.personinfo.email,callback:function(t){e.$set(e.personinfo,"email",t)},expression:"personinfo.email"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{model:{value:e.personinfo.address,callback:function(t){e.$set(e.personinfo,"address",t)},expression:"personinfo.address"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"邮编",prop:"zipcode"}},[a("el-input",{model:{value:e.personinfo.zipcode,callback:function(t){e.$set(e.personinfo,"zipcode",t)},expression:"personinfo.zipcode"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"IP地址",prop:"ipaddress","label-width":"100px"}},[a("el-input",{model:{value:e.personinfo.ipaddress,callback:function(t){e.$set(e.personinfo,"ipaddress",t)},expression:"personinfo.ipaddress"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"MAC地址",prop:"macaddress","label-width":"100px"}},[a("el-input",{model:{value:e.personinfo.macaddress,callback:function(t){e.$set(e.personinfo,"macaddress",t)},expression:"personinfo.macaddress"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注",prop:"tips"}},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.personinfo.tips,callback:function(t){e.$set(e.personinfo,"tips",t)},expression:"personinfo.tips"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"content-footer"},[a("button",{staticClass:"btn btn-default btn-large",on:{click:function(t){e.resetForm("personinfo")}}},[e._v("重置")]),e._v(" "),a("button",{staticClass:"btn btn-primarys btn-large",on:{click:function(t){e.submitForm("personinfo")}}},[e._v("保存")])])],1)])]),e._v(" "),a("el-dialog",{attrs:{"modal-append-to-body":!1,title:"机构",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tree",{ref:"tree",attrs:{data:e.resourceData,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.resourceCheckedKey,props:e.resourceProps,"check-strictly":"true"},on:{"node-click":e.handleNodeClick,"check-change":e.handleClicks}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dailogconfirm()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=function(e){a("ug/p")},r=a("VU/8")(s.a,i,!1,o,"data-v-7b37ec2a",null);t.default=r.exports},a98I:function(e,t,a){"use strict";(function(e){var s=a("QmSG"),i=a("xW+U"),o=a("GkRW"),r=a("h7vj"),n=a("zL8q");a.n(n);t.a={name:"personinfo",components:{vheader:o.a,navs_header:r.a},data:function(){return{loading:!1,docParm:{},basic_url:s.a.dev_url,file_url:s.a.file_url,editSearch:"","启用":1,"冻结":0,"男":1,"女":0,activeNames:["1","2"],show:!1,userList:[],selectData:[],isShow:!1,ismin:!0,fullHeight:document.documentElement.clientHeight-210+"px",headImgUrl:"",fileid:1,labelPosition:"top",dialogVisible:!1,personinfo:{worknumber:"",companyId:"",companyName:"",deptId:"",deptID:"",nickname:"",username:"",enabled:"",enabledName:"",password:"",birthday:"",sex:"",idnumber:"",roleId:[],roles:[],entrytime:"",email:"",phone:"",address:"",tips:"",telephone:"",zipcode:"",ipaddress:"",macaddress:""},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"fullname"},rules:{roleId:[{required:!0,trigger:"blur",message:"必填"}],nickname:[{required:!0,trigger:"blur",validator:i.a.isNickname}],worknumber:[{required:!0,trigger:"blur",message:"必填"},{validator:i.a.isWorknumber,trigger:"blur"}],email:[{required:!0,trigger:"blur",message:"必填"},{validator:i.a.isEmail,trigger:"blur"}],telephone:[{required:!1,trigger:"blur",validator:i.a.isTelephone}],phone:[{required:!0,trigger:"blur",message:"必填"},{validator:i.a.isPhone,trigger:"blur"}],idnumber:[{required:!1,trigger:"blur",validator:i.a.isIdnumber}],address:[{required:!1,trigger:"blur",validator:i.a.isSpecificKey}],zipcode:[{required:!1,trigger:"blur",validator:i.a.isZipcode}],ipaddress:[{required:!1,trigger:"blur",validator:i.a.isIpaddress}],macaddress:[{required:!1,trigger:"blur",validator:i.a.isMacaddress}],post:[{required:!1,trigger:"blur",validator:i.a.isSpecificKey}],tips:[{required:!1,trigger:"blur",validator:i.a.isSpecificKey}]},leftNavs:[{navicon:"icon-user",navtitle:"个人资料",navherf:"/personinfo"},{navicon:"icon-edit",navtitle:"修改密码",navherf:"/passwordedit"}]}},methods:{upload:function(e){var t=this,a=new FormData;this.loading=!0,this.$emit("showLoading"),a.append("files",document.getElementById("excelFile").files[0]);var s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var a=(e.loaded/e.total*100|0)+"%";t.progress=a}},i=this.file_url+"/file/uploadIcon?userid="+this.docParm.userid+"&username="+this.docParm.username+"&deptid="+this.docParm.deptid+"&deptfullname="+this.docParm.deptfullname+"&recordid=1&appname=icon&appid=99&pathid=5";""!=this.headImgUrl&&(i+="&fileid="+this.fileid),this.$axios.post(i,a,s).then(function(e){if(t.loading=!1,0==e.data.code)t.$message({message:e.data.message,type:"error"});else{t.$message({message:"文件已成功上传至服务器",type:"success"}),t.headImgUrl=e.data.icon;var a=t;setTimeout(function(){a.$router.go(0)},300)}})},getData:function(){var e=this,t=this.basic_url+"/api-user/users/currentMap";this.$axios.get(t,{}).then(function(t){e.personinfo=t.data,e.personinfo.roleId=[];var a=t.data.roles;e.docParm.userid=t.data.id,e.docParm.username=t.data.username,e.docParm.deptid=t.data.deptId,e.docParm.deptfullname=t.data.deptName;for(var s=0;s<a.length;s++)e.personinfo.roleId.push(a[s].id);e.getImgUrl()}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},getImgUrl:function(){var e=this,t=this.file_url+"/file/icon?appname=icon&userid="+this.docParm.userid;this.$axios.get(t,{}).then(function(t){1==t.data.code?(e.headImgUrl=t.data.icon,e.fileid=t.data.fileid):(e.headImgUrl="",e.fileid=0)})},handleNodeClick:function(e){},handleClicks:function(e,t,a){this.getCheckboxData=e,this.i++,this.i%2==0&&(t?(this.$refs.tree.setCheckedNodes([]),this.$refs.tree.setCheckedNodes([e])):this.$refs.tree.setCheckedNodes([]))},getDept:function(){var e=this;this.editSearch="dept";var t=this.basic_url+"/api-user/depts/treeMap";this.$axios.get(t,{}).then(function(t){console.log(t),e.resourceData=t.data.data,e.dialogVisible=!0})},getRole:function(){var e=this,t=this.basic_url+"/api-user/roles";this.$axios.get(t,{}).then(function(t){console.log(t.data.data),e.selectData=t.data.data}).catch(function(e){console.log("请求失败")})},getCheckedNodes:function(){this.checkedNodes=this.$refs.tree.getCheckedNodes()},dailogconfirm:function(){this.getCheckedNodes(),this.dialogVisible=!1,"company"==this.editSearch?(this.personinfo.companyId=this.checkedNodes[0].id,this.personinfo.companyName=this.checkedNodes[0].fullname):(this.personinfo.deptId=this.checkedNodes[0].id,this.personinfo.deptID=this.checkedNodes[0].fullname)},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=t.basic_url+"/api-user/users/me",s=t.personinfo,i=t;s.sex="男"==s.sex?1:0;var o="";if("undefind"!=typeof s.roleId&&s.roleId.length>0){var r=[];s.roleId.forEach(function(e){for(var t=i.selectData,a=0;a<t.length;a++)t[a].id==e&&(r.push(t[a]),o=o+t[a].id+",")}),s.roleId=o,s.roles=r}else s.roleId="",s.roles=[];t.$axios.put(a,t.personinfo).then(function(e){0==e.data.resp_code&&t.$message({message:"保存成功",type:"success"})}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})})},resetForm:function(e){this.$refs[e].resetFields()},handleAvatarSuccess:function(e,t){this.headImgUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},editpassword:function(){this.$router.push({path:"/passwordedit"})},min2max:function(){"220"==e(".navbar-static-side").width()?(e(".wrapper").css("padding-left","220px"),e(".navs>li").css("margin","0px 10px"),this.maxDialog()):"40"==e(".navbar-static-side").width()&&(e(".wrapper").css("padding-left","40px"),e(".navs>li").css("margin","0"),this.rebackDialog()),this.ismin=!this.ismin},maxDialog:function(t){e(".navbar-static-side").css("width","40px"),e(".wrapper").css("padding-left","40px"),e(".navs>li").css("margin","0")},rebackDialog:function(){e(".navbar-static-side").css("width","220px"),e(".wrapper").css("padding-left","220px"),e(".navs>li").css("margin","0px 10px")}},mounted:function(){this.getData(),this.getRole()}}}).call(t,a("7t+N"))},"ug/p":function(e,t){}});
//# sourceMappingURL=53.0d250a146d302e194be3.js.map