webpackJsonp([53],{CLxh:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("a98I"),o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"headerbg"},[s("vheader"),e._v(" "),s("navs_header")],1),e._v(" "),s("div",{staticClass:"contentbg"},[s("div",{staticClass:"navbar-default navbar-static-side"},[s("div",{attrs:{id:"sidebar-collapse"}},[s("div",{staticClass:"navbarbg"},[s("span",{staticClass:"navbar-minimalize minimalize-styl-2",on:{click:function(t){e.min2max()}}},[s("i",{staticClass:"icon-menu1"})])]),e._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"navs",attrs:{id:"side-menu"}},e._l(e.leftNavs,function(t,a){return s("li",{key:a},[s("router-link",{attrs:{to:t.navherf}},[s("i",{class:t.navicon}),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.ismin,expression:"ismin"}],staticClass:"nav-label"},[e._v(e._s(t.navtitle))])])],1)}))])]),e._v(" "),s("div",{staticClass:"wrapper wrapper-content"},[s("div",{staticClass:"ibox-content",style:{height:e.fullHeight}},[s("el-form",{ref:"personinfo",attrs:{model:e.personinfo,rules:e.rules,"label-width":"80px","label-position":e.labelPosition}},[s("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"账号设置",name:"1"}},[s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{attrs:{disabled:""},model:{value:e.personinfo.username,callback:function(t){e.$set(e.personinfo,"username",t)},expression:"personinfo.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"姓名",prop:"nickname"}},[s("el-input",{model:{value:e.personinfo.nickname,callback:function(t){e.$set(e.personinfo,"nickname",t)},expression:"personinfo.nickname"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"工号",prop:"worknumber"}},[s("el-input",{model:{value:e.personinfo.worknumber,callback:function(t){e.$set(e.personinfo,"worknumber",t)},expression:"personinfo.worknumber"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"密码"}},[s("el-input",{attrs:{type:"password",disabled:""},model:{value:e.personinfo.password,callback:function(t){e.$set(e.personinfo,"password",t)},expression:"personinfo.password"}},[s("el-button",{attrs:{slot:"append",icon:"icon-edit"},on:{click:e.editpassword},slot:"append"})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"职务",prop:"post"}},[s("el-input",{model:{value:e.personinfo.post,callback:function(t){e.$set(e.personinfo,"post",t)},expression:"personinfo.post"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"入职日期"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.personinfo.workdate,callback:function(t){e.$set(e.personinfo,"workdate",t)},expression:"personinfo.workdate"}})],1)],1),e._v(" "),s("el-col",{staticClass:"pt30",attrs:{span:8}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,title:"上传头像"}},[e.headImgUrl?s("img",{staticClass:"avatar",attrs:{src:e.headImgUrl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},["admin"===e.personinfo.username?s("el-form-item",{attrs:{label:"所属机构",prop:"deptName"}},[s("el-input",{attrs:{disabled:""},model:{value:e.personinfo.deptName,callback:function(t){e.$set(e.personinfo,"deptName",t)},expression:"personinfo.deptName"}},[s("el-button",{attrs:{slot:"append",icon:"icon-search"},on:{click:e.getDept},slot:"append"})],1)],1):s("el-form-item",{attrs:{label:"所属机构",prop:"deptName"}},[s("el-input",{attrs:{disabled:""},model:{value:e.personinfo.deptName,callback:function(t){e.$set(e.personinfo,"deptName",t)},expression:"personinfo.deptName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"角色",prop:"roleId","label-width":"100px"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.personinfo.roleId,callback:function(t){e.$set(e.personinfo,"roleId",t)},expression:"personinfo.roleId"}},e._l(e.selectData,function(e){return s("el-option",{key:e.name,attrs:{value:e.id,label:e.name}})}))],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"最高学历"}},[s("el-input",{attrs:{disabled:""},model:{value:e.personinfo.education,callback:function(t){e.$set(e.personinfo,"education",t)},expression:"personinfo.education"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:9}},[s("el-form-item",{attrs:{label:"允许登录",prop:"islogin","label-width":"100px"}},[s("el-radio-group",{model:{value:e.personinfo.islogin,callback:function(t){e.$set(e.personinfo,"islogin",t)},expression:"personinfo.islogin"}},[s("el-radio",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:"2"}},[e._v("否")])],1)],1)],1)],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"基本资料",name:"2"}},[s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"身份证号",prop:"idnumber"}},[s("el-input",{model:{value:e.personinfo.idnumber,callback:function(t){e.$set(e.personinfo,"idnumber",t)},expression:"personinfo.idnumber"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"性别"}},[s("el-radio-group",{model:{value:e.personinfo.sex,callback:function(t){e.$set(e.personinfo,"sex",t)},expression:"personinfo.sex"}},[s("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),s("el-radio",{attrs:{label:0}},[e._v("女")])],1)],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{model:{value:e.personinfo.phone,callback:function(t){e.$set(e.personinfo,"phone",t)},expression:"personinfo.phone"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"出生日期"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.personinfo.birthday,callback:function(t){e.$set(e.personinfo,"birthday",t)},expression:"personinfo.birthday"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[s("el-input",{model:{value:e.personinfo.telephone,callback:function(t){e.$set(e.personinfo,"telephone",t)},expression:"personinfo.telephone"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[s("el-input",{model:{value:e.personinfo.email,callback:function(t){e.$set(e.personinfo,"email",t)},expression:"personinfo.email"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:16}},[s("el-form-item",{attrs:{label:"地址",prop:"address"}},[s("el-input",{model:{value:e.personinfo.address,callback:function(t){e.$set(e.personinfo,"address",t)},expression:"personinfo.address"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"邮编",prop:"zipcode"}},[s("el-input",{model:{value:e.personinfo.zipcode,callback:function(t){e.$set(e.personinfo,"zipcode",t)},expression:"personinfo.zipcode"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"IP地址",prop:"ipaddress","label-width":"100px"}},[s("el-input",{model:{value:e.personinfo.ipaddress,callback:function(t){e.$set(e.personinfo,"ipaddress",t)},expression:"personinfo.ipaddress"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"MAC地址",prop:"macaddress","label-width":"100px"}},[s("el-input",{model:{value:e.personinfo.macaddress,callback:function(t){e.$set(e.personinfo,"macaddress",t)},expression:"personinfo.macaddress"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:24}},[s("el-form-item",{attrs:{label:"备注",prop:"tips"}},[s("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.personinfo.tips,callback:function(t){e.$set(e.personinfo,"tips",t)},expression:"personinfo.tips"}})],1)],1)],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"content-footer"},[s("button",{staticClass:"btn btn-default btn-large",on:{click:function(t){e.resetForm("personinfo")}}},[e._v("重置")]),e._v(" "),s("button",{staticClass:"btn btn-primarys btn-large",on:{click:function(t){e.submitForm("personinfo")}}},[e._v("保存")])])],1)])]),e._v(" "),s("el-dialog",{attrs:{"modal-append-to-body":!1,title:"机构",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-tree",{ref:"tree",attrs:{data:e.resourceData,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.resourceCheckedKey,props:e.resourceProps,"check-strictly":"true"},on:{"node-click":e.handleNodeClick,"check-change":e.handleClicks}}),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dailogconfirm()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=function(e){s("rhxQ")},r=s("VU/8")(a.a,o,!1,i,"data-v-64103f74",null);t.default=r.exports},a98I:function(e,t,s){"use strict";(function(e){var a=s("QmSG"),o=s("xW+U"),i=s("GkRW"),r=s("h7vj");t.a={name:"personinfo",components:{vheader:i.a,navs_header:r.a},data:function(){return{basic_url:a.a.dev_url,editSearch:"","启用":1,"冻结":0,"男":1,"女":0,activeNames:["1","2"],show:!1,userList:[],selectData:[],isShow:!1,ismin:!0,fullHeight:document.documentElement.clientHeight-210+"px",headImgUrl:"",labelPosition:"top",dialogVisible:!1,personinfo:{worknumber:"",companyId:"",companyName:"",deptId:"",deptID:"",nickname:"",username:"",enabled:"",enabledName:"",password:"",birthday:"",sex:"",idnumber:"",roleId:[],roles:[],entrytime:"",email:"",phone:"",address:"",tips:"",telephone:"",zipcode:"",ipaddress:"",macaddress:""},resourceData:[],resourceDialogisShow:!1,resourceCheckedKey:[],resourceProps:{children:"subDepts",label:"fullname"},rules:{roleId:[{required:!0,trigger:"blur",message:"必填"}],nickname:[{required:!0,trigger:"blur",validator:o.a.isNickname}],worknumber:[{required:!0,trigger:"blur",message:"必填"},{validator:o.a.isWorknumber,trigger:"blur"}],email:[{required:!0,trigger:"blur",message:"必填"},{validator:o.a.isEmail,trigger:"blur"}],telephone:[{required:!1,trigger:"blur",validator:o.a.isTelephone}],phone:[{required:!0,trigger:"blur",message:"必填"},{validator:o.a.isPhone,trigger:"blur"}],idnumber:[{required:!1,trigger:"blur",validator:o.a.isIdnumber}],address:[{required:!1,trigger:"blur",validator:o.a.isSpecificKey}],zipcode:[{required:!1,trigger:"blur",validator:o.a.isZipcode}],ipaddress:[{required:!1,trigger:"blur",validator:o.a.isIpaddress}],macaddress:[{required:!1,trigger:"blur",validator:o.a.isMacaddress}],post:[{required:!1,trigger:"blur",validator:o.a.isSpecificKey}],tips:[{required:!1,trigger:"blur",validator:o.a.isSpecificKey}]},leftNavs:[{navicon:"icon-user",navtitle:"个人资料",navherf:"/personinfo"},{navicon:"icon-edit",navtitle:"修改密码",navherf:"/passwordedit"}]}},methods:{getData:function(){var e=this,t=this.basic_url+"/api-user/users/currentMap";this.$axios.get(t,{}).then(function(t){console.log(e.personinfo),e.personinfo=t.data,e.personinfo.roleId=[];for(var s=t.data.roles,a=0;a<s.length;a++)e.personinfo.roleId.push(s[a].id)}).catch(function(t){e.$message({message:"网络错误，请重试",type:"error"})})},handleNodeClick:function(e){},handleClicks:function(e,t,s){this.getCheckboxData=e,this.i++,this.i%2==0&&(t?(this.$refs.tree.setCheckedNodes([]),this.$refs.tree.setCheckedNodes([e])):this.$refs.tree.setCheckedNodes([]))},getDept:function(){var e=this;this.editSearch="dept";var t=this.basic_url+"/api-user/depts/treeMap";this.$axios.get(t,{}).then(function(t){console.log(t),e.resourceData=t.data.data,e.dialogVisible=!0})},getRole:function(){var e=this,t=this.basic_url+"/api-user/roles";this.$axios.get(t,{}).then(function(t){console.log(t.data.data),e.selectData=t.data.data}).catch(function(e){console.log("请求失败")})},getCheckedNodes:function(){this.checkedNodes=this.$refs.tree.getCheckedNodes()},dailogconfirm:function(){this.getCheckedNodes(),this.dialogVisible=!1,"company"==this.editSearch?(this.personinfo.companyId=this.checkedNodes[0].id,this.personinfo.companyName=this.checkedNodes[0].fullname):(this.personinfo.deptId=this.checkedNodes[0].id,this.personinfo.deptID=this.checkedNodes[0].fullname)},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var s=t.basic_url+"/api-user/users/me",a=t.personinfo,o=t;a.sex="男"==a.sex?1:0;var i="";if("undefind"!=typeof a.roleId&&a.roleId.length>0){var r=[];a.roleId.forEach(function(e){for(var t=o.selectData,s=0;s<t.length;s++)t[s].id==e&&(r.push(t[s]),i=i+t[s].id+",")}),a.roleId=i,a.roles=r}else a.roleId="",a.roles=[];t.$axios.put(s,t.personinfo).then(function(e){0==e.data.resp_code&&t.$message({message:"保存成功",type:"success"})}).catch(function(e){t.$message({message:"网络错误，请重试",type:"error"})})})},resetForm:function(e){this.$refs[e].resetFields()},handleAvatarSuccess:function(e,t){this.headImgUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,s=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&s},editpassword:function(){this.$router.push({path:"/passwordedit"})},min2max:function(){"220"==e(".navbar-static-side").width()?(e(".wrapper").css("padding-left","220px"),e(".navs>li").css("margin","0px 10px"),this.maxDialog()):"40"==e(".navbar-static-side").width()&&(e(".wrapper").css("padding-left","40px"),e(".navs>li").css("margin","0"),this.rebackDialog()),this.ismin=!this.ismin},maxDialog:function(t){e(".navbar-static-side").css("width","40px"),e(".wrapper").css("padding-left","40px"),e(".navs>li").css("margin","0")},rebackDialog:function(){e(".navbar-static-side").css("width","220px"),e(".wrapper").css("padding-left","220px"),e(".navs>li").css("margin","0px 10px")}},mounted:function(){this.getData(),this.getRole()}}}).call(t,s("7t+N"))},rhxQ:function(e,t){}});
//# sourceMappingURL=53.4465c8d1e443606f298f.js.map